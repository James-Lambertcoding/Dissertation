capital_price = test_function_cal[[12]][,1],
labour_price = test_function_cal[[10]],
capital =  test_function_cal[[11]],
labour = test_function_cal[[9]])
## 2.2 test_pi ----------------------
test_pi <- function_delta_pi_j(price = test_function_cal[[7]],
A_j = test_function_cal[[5]],
beta = test_function_cal[[3]],
primary_costs = test_function_cal[[12]],
gamma_capital =  test_function_cal[[4]][,1],
gamma_labour = test_function_cal[[4]][,2],
runs = runs)
## 2.4 test_m ----------------------
test_m <- function_delta_m(salary = test_function_cal[[10]],
labour = test_function_cal[[9]],
capital = test_function_cal[[11]],
interest_rate = Interest_rate,
m_tot = test_function_cal[[13]]
)
## Debugging purposes
# results_list <- list()
#
# results_list[[1]] <- test_c
# results_list[[2]] <- test_F
# results_list[[3]] <- test_pi
# results_list[[4]] <- test_m
## 2.5 Changes -----------------------
## once the deltas are calculated the Z vector has to be changed
## the constant in this is W the wage amount
## 2.5.1 New prices -----------------
max_pi <- max(test_c)
min_pi <- min(test_c)
max_price <-max(test_function_cal[[7]])
min_price <- min(test_function_cal[[7]])
new_max_price <- max_price*alter_factor
new_min_price <- min_price/alter_factor
new_prices <- rep(1, length(sectors))
# new_price_df <- data.frame("price" = new_prices,
#                            "direction" =  rep(0),
#                            "change" = rep(0))
for(i in 1:length(sectors)){
if(test_c[i] > 0){
new_prices[i] <- test_function_cal[[7]][i] + ((new_max_price-test_function_cal[[7]][i])*(test_c[i]/max_pi))
} else if(test_c[i] < 0) {
new_prices[i] <- test_function_cal[[7]][i] - ((test_function_cal[[7]][i]-new_min_price)*(test_c[i]/min_pi))
}
}
## 2.5.2 New Wages -----------------------------------
new_labour_prices <- test_function_cal[[10]]
new_capital_prices <-
## check how deltas are evolving
delta_amount <- rep(0,4)
for(i in length(test_c)){
delta_amount[1] <- delta_amount[1]+ abs(test_c[i])
}
for(i in length(test_F)){
delta_amount[2] <- delta_amount[2]+ abs(test_F[[1]][i])
}
for(i in length(test_pi)){
delta_amount[3] <- delta_amount[3]+ abs(test_pi[i])
}
for(i in length(test_m)){
delta_amount[4] <- delta_amount[4]+ abs(test_m[i])
}
return_list <- list()
return_list[[1]] <- new_prices
return_list[[2]] <- delta_amount
return_list[[3]] <- test_F
return(return_list)
}
source("F:/My Drive/EMAP/101 Dissertation/Dissertation/R Model/04_CGE_Functions.R", echo=TRUE)
source("F:/My Drive/EMAP/101 Dissertation/Dissertation/R Model/04_CGE_Functions_v_2.R", echo=TRUE)
source("F:/My Drive/EMAP/101 Dissertation/Dissertation/R Model/03_Calibration_v3.R", echo=TRUE)
test_function_cal_first <- function_calibration_3(price = price_cal_test,
labour = labour_cal_test,
capital = capital_cal_test,
inter_goods_coef = ig_coef_sum,
inter_totals = inter_total_cal_test,
salary = salary_cal_test,
interest_rate = interest_rate_cal_test,
demand_ratio = demand_ratios_cal_test,
sectors = sectors)
cal_input <- list()
delta_list <- list()
prices_list <-list()
delta_F_list <- list()
for (m in 1:runs) {
cal_input[[m]] <- list()
}
for(m in 1:runs){
cal_input[[1]] <- test_function_cal_first
test_delta_function <- function_test_delta_2(test_function_cal =  cal_input[[m]], runs = m)
delta_list[[m]] <- test_delta_function[[2]]
prices_list[[m]] <- test_delta_function[[1]]
delta_F_list[[m]] <- test_delta_function[[3]]
test_function_cal_step <- function_calibration_3(price = test_delta_function[[1]],
labour = cal_input[[m]][[9]],
capital = cal_input[[m]][[11]],
inter_totals = cal_input[[m]][[14]],
inter_goods_coef = ig_coef_sum,
salary = salary_cal_test,
interest_rate = cal_input[[m]][[15]],
demand_ratio = demand_ratios_cal_test,
sectors = sectors)
cal_input[[m+1]] <- test_function_cal_step
}
source("F:/My Drive/EMAP/101 Dissertation/Dissertation/R Model/04_CGE_Functions.R", echo=TRUE)
source("F:/My Drive/EMAP/101 Dissertation/Dissertation/R Model/04_CGE_Functions_v_2.R", echo=TRUE)
test_function_cal_first <- function_calibration_3(price = price_cal_test,
labour = labour_cal_test,
capital = capital_cal_test,
inter_goods_coef = ig_coef_sum,
inter_totals = inter_total_cal_test,
salary = salary_cal_test,
interest_rate = interest_rate_cal_test,
demand_ratio = demand_ratios_cal_test,
sectors = sectors)
cal_input <- list()
delta_list <- list()
prices_list <-list()
delta_F_list <- list()
for (m in 1:runs) {
cal_input[[m]] <- list()
}
for(m in 1:runs){
cal_input[[1]] <- test_function_cal_first
test_delta_function <- function_test_delta_2(test_function_cal =  cal_input[[m]], runs = m)
delta_list[[m]] <- test_delta_function[[2]]
prices_list[[m]] <- test_delta_function[[1]]
delta_F_list[[m]] <- test_delta_function[[3]]
test_function_cal_step <- function_calibration_3(price = test_delta_function[[1]],
labour = cal_input[[m]][[9]],
capital = cal_input[[m]][[11]],
inter_totals = cal_input[[m]][[14]],
inter_goods_coef = ig_coef_sum,
salary = salary_cal_test,
interest_rate = cal_input[[m]][[15]],
demand_ratio = demand_ratios_cal_test,
sectors = sectors)
cal_input[[m+1]] <- test_function_cal_step
}
source("F:/My Drive/EMAP/101 Dissertation/Dissertation/R Model/02_read_data_v2.R", echo=TRUE)
Bench_year <- 2015
Interest_rate <- 0.1
effective_tax <- 0.3
min_price <- 0.001
alter_factor <- 2
runs <- 3
## Packages
source("01_Packages.R")
## Data
source("02_read_data_v2.R")
## Calibration
source("03_Calibration_v3.R")
## General Equilibrium Functions
source("04_CGE_Functions.R")
## take data from read_data_function
price_cal_test  <- rep(1, length(sectors))
labour_cal_test  <- primary_factor_2015[,"labour"]
capital_cal_test <- primary_factor_2015[,"capital"]
inter_goods_cal_test <- ig_amt_aut %>%
select(-Sectors)
inter_total_cal_test <- ig_sum_aut[,"new_int_good"]
salary_cal_test <- sala_df[,"salary"]
interest_rate_cal_test <- rep(Interest_rate,length(sectors))
demand_ratios_cal_test <- demand_ratio_2015
sectors_cal_test <- sectors
test_function_cal_first <- function_calibration_3(price = price_cal_test,
labour = labour_cal_test,
capital = capital_cal_test,
inter_goods_coef = ig_coef_sum,
inter_totals = inter_total_cal_test,
salary = salary_cal_test,
interest_rate = interest_rate_cal_test,
demand_ratio = demand_ratios_cal_test,
sectors = sectors)
cal_input <- list()
delta_list <- list()
prices_list <-list()
delta_F_list <- list()
for (m in 1:runs) {
cal_input[[m]] <- list()
}
for(m in 1:runs){
cal_input[[1]] <- test_function_cal_first
test_delta_function <- function_test_delta_2(test_function_cal =  cal_input[[m]], runs = m)
delta_list[[m]] <- test_delta_function[[2]]
prices_list[[m]] <- test_delta_function[[1]]
delta_F_list[[m]] <- test_delta_function[[3]]
test_function_cal_step <- function_calibration_3(price = test_delta_function[[1]],
labour = cal_input[[m]][[9]],
capital = cal_input[[m]][[11]],
inter_totals = cal_input[[m]][[14]],
inter_goods_coef = ig_coef_sum,
salary = salary_cal_test,
interest_rate = cal_input[[m]][[15]],
demand_ratio = demand_ratios_cal_test,
sectors = sectors)
cal_input[[m+1]] <- test_function_cal_step
}
delta_list
source("F:/My Drive/EMAP/101 Dissertation/Dissertation/R Model/04_CGE_Functions_v_2.R", echo=TRUE)
## Calibration
source("03_Calibration_v3.R")
## General Equilibrium Functions
source("04_CGE_Functions.R")
## General Equilibrium Functions
source("04_CGE_Functions_v_2.R")
## take data from read_data_function
price_cal_test  <- rep(1, length(sectors))
labour_cal_test  <- primary_factor_2015[,"labour"]
capital_cal_test <- primary_factor_2015[,"capital"]
inter_goods_cal_test <- ig_amt_aut %>%
select(-Sectors)
inter_total_cal_test <- ig_sum_aut[,"new_int_good"]
salary_cal_test <- sala_df[,"salary"]
interest_rate_cal_test <- rep(Interest_rate,length(sectors))
demand_ratios_cal_test <- demand_ratio_2015
sectors_cal_test <- sectors
## Start Point Data
source("02a_Start_point_data.R")
## Calibration
source("03_Calibration_v3.R")
## General Equilibrium Functions
source("04_CGE_Functions.R")
## General Equilibrium Functions
source("04_CGE_Functions_v_2.R")
test_function_cal_first <- function_calibration_3(price = price_cal_test,
labour = labour_cal_test,
capital = capital_cal_test,
inter_goods_coef = ig_coef_sum,
inter_totals = inter_total_cal_test,
salary = salary_cal_test,
interest_rate = interest_rate_cal_test,
demand_ratio = demand_ratios_cal_test,
sectors = sectors)
cal_input <- list()
delta_list <- list()
prices_list <-list()
delta_F_list <- list()
for (m in 1:runs) {
cal_input[[m]] <- list()
}
for(m in 1:runs){
cal_input[[1]] <- test_function_cal_first
test_delta_function <- function_test_delta_2(test_function_cal =  cal_input[[m]], runs = m)
delta_list[[m]] <- test_delta_function[[2]]
prices_list[[m]] <- test_delta_function[[1]]
delta_F_list[[m]] <- test_delta_function[[3]]
test_function_cal_step <- function_calibration_3(price = test_delta_function[[1]],
labour = cal_input[[m]][[9]],
capital = cal_input[[m]][[11]],
inter_totals = cal_input[[m]][[14]],
inter_goods_coef = ig_coef_sum,
salary = test_delta_function[[4]],
interest_rate = cal_input[[m]][[15]],
demand_ratio = demand_ratios_cal_test,
sectors = sectors)
cal_input[[m+1]] <- test_function_cal_step
}
## Packages
source("01_Packages.R")
## Data
source("02_read_data_v2.R")
## Start Point Data
source("02a_Start_point_data.R")
## Calibration
source("03_Calibration_v3.R")
## General Equilibrium Functions
source("04_CGE_Functions.R")
## General Equilibrium Functions
source("04_CGE_Functions_v_2.R")
test_function_cal_first <- function_calibration_3(price = price_cal_test,
labour = labour_cal_test,
capital = capital_cal_test,
inter_goods_coef = ig_coef_sum,
inter_totals = inter_total_cal_test,
salary = salary_cal_test,
interest_rate = interest_rate_cal_test,
demand_ratio = demand_ratios_cal_test,
sectors = sectors)
cal_input <- list()
delta_list <- list()
prices_list <-list()
delta_F_list <- list()
source("F:/My Drive/EMAP/101 Dissertation/Dissertation/R Model/02a_Start_point_data.R", echo=TRUE)
test_function_cal_first <- function_calibration_3(price = price_cal_test,
labour = labour_cal_test,
capital = capital_cal_test,
inter_goods_coef = ig_coef_sum,
inter_totals = inter_total_cal_test,
salary = salary_cal_test,
interest_rate = interest_rate_cal_test,
demand_ratio = demand_ratios_cal_test,
sectors = sectors)
for (m in 1:runs) {
cal_input[[m]] <- list()
}
cal_input[[m]] <- list()
for (m in 1:runs) {
cal_input[[m]] <- list()
}
for(m in 1:runs){
cal_input[[1]] <- test_function_cal_first
test_delta_function <- function_test_delta_2(test_function_cal =  cal_input[[m]], runs = m)
delta_list[[m]] <- test_delta_function[[2]]
prices_list[[m]] <- test_delta_function[[1]]
delta_F_list[[m]] <- test_delta_function[[3]]
test_function_cal_step <- function_calibration_3(price = test_delta_function[[1]],
labour = cal_input[[m]][[9]],
capital = cal_input[[m]][[11]],
inter_totals = cal_input[[m]][[14]],
inter_goods_coef = ig_coef_sum,
salary = test_delta_function[[4]],
interest_rate = cal_input[[m]][[15]],
demand_ratio = demand_ratios_cal_test,
sectors = sectors)
cal_input[[m+1]] <- test_function_cal_step
}
source("F:/My Drive/EMAP/101 Dissertation/Dissertation/R Model/04_CGE_Functions_v_2.R", echo=TRUE)
source("F:/My Drive/EMAP/101 Dissertation/Dissertation/R Model/02a_Start_point_data.R", echo=TRUE)
for(m in 1:runs){
cal_input[[1]] <- test_function_cal_first
test_delta_function <- function_test_delta_2(test_function_cal =  cal_input[[m]], runs = m)
delta_list[[m]] <- test_delta_function[[2]]
prices_list[[m]] <- test_delta_function[[1]]
delta_F_list[[m]] <- test_delta_function[[3]]
test_function_cal_step <- function_calibration_3(price = test_delta_function[[1]],
labour = cal_input[[m]][[9]],
capital = cal_input[[m]][[11]],
inter_totals = cal_input[[m]][[14]],
inter_goods_coef = ig_coef_sum,
salary = test_delta_function[[4]],
interest_rate = cal_input[[m]][[15]],
demand_ratio = demand_ratios_cal_test,
sectors = sectors)
cal_input[[m+1]] <- test_function_cal_step
}
delta_list
test_delta_function[[4]]
for(m in 1:runs){
cal_input[[1]] <- test_function_cal_first
test_delta_function <- function_test_delta_2(test_function_cal =  cal_input[[m]], runs = m)
delta_list[[m]] <- test_delta_function[[2]]
prices_list[[m]] <- test_delta_function[[1]]
delta_F_list[[m]] <- test_delta_function[[3]]
print(test_delta_function[[4]])
test_function_cal_step <- function_calibration_3(price = test_delta_function[[1]],
labour = cal_input[[m]][[9]],
capital = cal_input[[m]][[11]],
inter_totals = cal_input[[m]][[14]],
inter_goods_coef = ig_coef_sum,
salary = test_delta_function[[4]],
interest_rate = cal_input[[m]][[15]],
demand_ratio = demand_ratios_cal_test,
sectors = sectors)
cal_input[[m+1]] <- test_function_cal_step
}
delta_F_list
source("F:/My Drive/EMAP/101 Dissertation/Dissertation/R Model/04_CGE_Functions_v_2.R", echo=TRUE)
for(m in 1:runs){
cal_input[[1]] <- test_function_cal_first
test_delta_function <- function_test_delta_2(test_function_cal =  cal_input[[m]], runs = m)
delta_list[[m]] <- test_delta_function[[2]]
prices_list[[m]] <- test_delta_function[[1]]
delta_F_list[[m]] <- test_delta_function[[3]]
print(test_delta_function[[4]])
test_function_cal_step <- function_calibration_3(price = test_delta_function[[1]],
labour = cal_input[[m]][[9]],
capital = cal_input[[m]][[11]],
inter_totals = cal_input[[m]][[14]],
inter_goods_coef = ig_coef_sum,
salary = test_delta_function[[4]],
interest_rate = cal_input[[m]][[15]],
demand_ratio = demand_ratios_cal_test,
sectors = sectors)
cal_input[[m+1]] <- test_function_cal_step
}
delta_list
prices_list
runs <- 25
## Start Point Data
source("02a_Start_point_data.R")
test_function_cal_first <- function_calibration_3(price = price_cal_test,
labour = labour_cal_test,
capital = capital_cal_test,
inter_goods_coef = ig_coef_sum,
inter_totals = inter_total_cal_test,
salary = salary_cal_test,
interest_rate = interest_rate_cal_test,
demand_ratio = demand_ratios_cal_test,
sectors = sectors)
for(m in 1:runs){
cal_input[[1]] <- test_function_cal_first
test_delta_function <- function_test_delta_2(test_function_cal =  cal_input[[m]], runs = m)
delta_list[[m]] <- test_delta_function[[2]]
prices_list[[m]] <- test_delta_function[[1]]
delta_F_list[[m]] <- test_delta_function[[3]]
print(test_delta_function[[4]])
test_function_cal_step <- function_calibration_3(price = test_delta_function[[1]],
labour = cal_input[[m]][[9]],
capital = cal_input[[m]][[11]],
inter_totals = cal_input[[m]][[14]],
inter_goods_coef = ig_coef_sum,
salary = test_delta_function[[4]],
interest_rate = cal_input[[m]][[15]],
demand_ratio = demand_ratios_cal_test,
sectors = sectors)
cal_input[[m+1]] <- test_function_cal_step
print(m)
}
prices_list
delta_F_list
delta_list
source("F:/My Drive/EMAP/101 Dissertation/Dissertation/R Model/04_CGE_Functions_v_2.R", echo=TRUE)
runs <- 5
## Packages
source("01_Packages.R")
## Data
source("02_read_data_v2.R")
## Start Point Data
source("02a_Start_point_data.R")
## Calibration
source("03_Calibration_v3.R")
## General Equilibrium Functions
source("04_CGE_Functions.R")
## General Equilibrium Functions
source("04_CGE_Functions_v_2.R")
test_function_cal_first <- function_calibration_3(price = price_cal_test,
labour = labour_cal_test,
capital = capital_cal_test,
inter_goods_coef = ig_coef_sum,
inter_totals = inter_total_cal_test,
salary = salary_cal_test,
interest_rate = interest_rate_cal_test,
demand_ratio = demand_ratios_cal_test,
sectors = sectors)
for(m in 1:runs){
cal_input[[1]] <- test_function_cal_first
test_delta_function <- function_test_delta_2(test_function_cal =  cal_input[[m]], runs = m)
delta_list[[m]] <- test_delta_function[[2]]
prices_list[[m]] <- test_delta_function[[1]]
delta_F_list[[m]] <- test_delta_function[[3]]
print(test_delta_function[[4]])
test_function_cal_step <- function_calibration_3(price = test_delta_function[[1]],
labour = cal_input[[m]][[9]],
capital = cal_input[[m]][[11]],
inter_totals = cal_input[[m]][[14]],
inter_goods_coef = ig_coef_sum,
salary = test_delta_function[[4]],
interest_rate = cal_input[[m]][[15]],
demand_ratio = demand_ratios_cal_test,
sectors = sectors)
cal_input[[m+1]] <- test_function_cal_step
print(m)
}
delta_F_list
delta_list
source("F:/My Drive/EMAP/101 Dissertation/Dissertation/R Model/04_CGE_Functions_v_2.R", echo=TRUE)
runs <- 10
## Packages
source("01_Packages.R")
## Data
source("02_read_data_v2.R")
## Start Point Data
source("02a_Start_point_data.R")
## Calibration
source("03_Calibration_v3.R")
## General Equilibrium Functions
source("04_CGE_Functions.R")
## General Equilibrium Functions
source("04_CGE_Functions_v_2.R")
test_function_cal_first <- function_calibration_3(price = price_cal_test,
labour = labour_cal_test,
capital = capital_cal_test,
inter_goods_coef = ig_coef_sum,
inter_totals = inter_total_cal_test,
salary = salary_cal_test,
interest_rate = interest_rate_cal_test,
demand_ratio = demand_ratios_cal_test,
sectors = sectors)
for(m in 1:runs){
cal_input[[1]] <- test_function_cal_first
test_delta_function <- function_test_delta_2(test_function_cal =  cal_input[[m]], runs = m)
delta_list[[m]] <- test_delta_function[[2]]
prices_list[[m]] <- test_delta_function[[1]]
delta_F_list[[m]] <- test_delta_function[[3]]
print(test_delta_function[[4]])
test_function_cal_step <- function_calibration_3(price = test_delta_function[[1]],
labour = cal_input[[m]][[9]],
capital = cal_input[[m]][[11]],
inter_totals = cal_input[[m]][[14]],
inter_goods_coef = ig_coef_sum,
salary = test_delta_function[[4]],
interest_rate = cal_input[[m]][[15]],
demand_ratio = demand_ratios_cal_test,
sectors = sectors)
cal_input[[m+1]] <- test_function_cal_step
print(m)
}
delta_list
source("F:/My Drive/EMAP/101 Dissertation/Dissertation/R Model/00_Main_Model_v1.R", echo=TRUE)
source("F:/My Drive/EMAP/101 Dissertation/Dissertation/R Model/00_Main_Model_v1.R", echo=TRUE)
source("F:/My Drive/EMAP/101 Dissertation/Dissertation/R Model/00_Main_Model_v1.R", echo=TRUE)
source("F:/My Drive/EMAP/101 Dissertation/Dissertation/R Model/00_Main_Model_v1.R", echo=TRUE)
delta_list
source("F:/My Drive/EMAP/101 Dissertation/Dissertation/R Model/00_Main_Model_v1.R", echo=TRUE)
prices_list
delta_list
source("F:/My Drive/EMAP/101 Dissertation/Dissertation/R Model/03_Calibration_v3.R", echo=TRUE)
source("F:/My Drive/EMAP/101 Dissertation/Dissertation/R Model/00_Main_Model_v1.R", echo=TRUE)
delta_list
