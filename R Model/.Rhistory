cal_gamma <- data.frame("Sectors" = sectors,
"capital_gamma" = rep(0),
"labour_gamma" = rep(0))
for(i in 1:nrow(cal_gamma)){
cal_gamma[i,"capital_gamma"] <- prim_2015_df[4,i+2]/ig_tot_df_2[i,"total_demand"]
cal_gamma[i,"labour_gamma"] <- prim_2015_df[5,i+2]/(ig_tot_df_2[i,"total_demand"])
}
x_ij <- ig_tot_df_2 %>%
select(-Sectors, -total_demand)
rownames(x_ij) <- colnames(x_ij)
X_ij_b_ij <- x_ij
for(i in 1:nrow(X_ij_b_ij)){
for(j in 1:ncol(X_ij_b_ij)){
X_ij_b_ij[i,j] <- x_ij[i,j] ^ cal_beta[i,j]
}
}
cal_gamma_full <- cal_gamma %>%
mutate(capital = 0) %>%
mutate(labour = 0)
for(i in 1:nrow(cal_gamma_full)){
cal_gamma_full[i,"capital"] <- prim_2015_df[4,i+2]
cal_gamma_full[i,"labour"] <- prim_2015_df[5,i+2]
}
cal_gamma_full_2 <- cal_gamma_full %>%
mutate(capital_raised = capital ^ capital_gamma) %>%
mutate(labour_raised = labour ^ labour_gamma)
cal_gamma_full_2
prim_2015_df <- prim_df %>%
filter(Year == 2015)
cal_gamma <- data.frame("Sectors" = sectors,
"capital_gamma" = rep(0),
"labour_gamma" = rep(0))
for(i in 1:nrow(cal_gamma)){
cal_gamma[i,"capital_gamma"] <- prim_2015_df[4,i+2]/ig_tot_df_2[i,"total_demand"]
cal_gamma[i,"labour_gamma"] <- prim_2015_df[5,i+2]/(ig_tot_df_2[i,"total_demand"]*10^6)
}
x_ij <- ig_tot_df_2 %>%
select(-Sectors, -total_demand)
rownames(x_ij) <- colnames(x_ij)
X_ij_b_ij <- x_ij
for(i in 1:nrow(X_ij_b_ij)){
for(j in 1:ncol(X_ij_b_ij)){
X_ij_b_ij[i,j] <- x_ij[i,j] ^ cal_beta[i,j]
}
}
cal_gamma_full <- cal_gamma %>%
mutate(capital = 0) %>%
mutate(labour = 0)
for(i in 1:nrow(cal_gamma_full)){
cal_gamma_full[i,"capital"] <- prim_2015_df[4,i+2]*10^6
cal_gamma_full[i,"labour"] <- prim_2015_df[5,i+2]
}
cal_gamma_full_2 <- cal_gamma_full %>%
mutate(capital_raised = capital ^ capital_gamma) %>%
mutate(labour_raised = labour ^ labour_gamma)
cal_gamma_full_2
X_ij_b_ij
cal_a_j <-  data.frame("Sectors" = sectors,
"a_j" = rep(0))
for(i in 1:nrow(cal_a_j)){
cal_a_j[i,"a_j"] <- prod(X_ij_b_ij[,i])
}
cal_a_j
cal_a_j <-  data.frame("Sectors" = sectors,
"a_j" = rep(0))
for(i in 1:nrow(cal_a_j)){
cal_a_j[i,"a_j"] <- prod(X_ij_b_ij[,i], cal_gamma_full_2[,"capital_raised"],cal_gamma_full_2[,"labour_raised"])
}
cal_a_j
ig_tot_df_2[i,"total_demand"]
cal_a_j <-  data.frame("Sectors" = sectors,
"a_j" = rep(0))
for(i in 1:nrow(cal_a_j)){
cal_a_j[i,"a_j"] <- (ig_tot_df_2[i,"total_demand"]*10^6)/prod(X_ij_b_ij[,i], cal_gamma_full_2[,"capital_raised"],cal_gamma_full_2[,"labour_raised"])
}
cal_a_j
ig_tot_df_2
sala_name <- "Data/salary.csv"
sal_df <- read.csv(file= sala_name, stringsAsFactors = F)
sala_name <- "Data/salary.csv"
sal_df <- read.csv(file= sala_name, stringsAsFactors = F)
cal_gamma <- data.frame("Sectors" = sectors,
"capital_gamma" = rep(0),
"labour_gamma" = rep(0),
"salary" = rep(0))
sala_df <- read.csv(file= sala_name, stringsAsFactors = F)
cal_gamma <- cal_gamma %>%
left_join(sala_df, by = "Sectors")
cal_gamma
sala_df
sala_name <- "Data/salary.csv"
sala_df <- read.csv(file= sala_name, stringsAsFactors = F)
cal_gamma <- data.frame("Sectors" = sectors,
"capital_gamma" = rep(0),
"labour_gamma" = rep(0))
cal_gamma <- cal_gamma %>%
left_join(sala_df, by = "Sectors")
cal_gamma
for(i in 1:nrow(cal_gamma)){
cal_gamma[i,"capital_gamma"] <- prim_2015_df[4,i+2]/ig_tot_df_2[i,"total_demand"]
cal_gamma[i,"labour_gamma"] <- prim_2015_df[5,i+2]*cal_gamma[i,"salary"]/(ig_tot_df_2[i,"total_demand"]*10^6)
}
for(i in 1:nrow(cal_gamma)){
cal_gamma[i,"capital_gamma"] <- prim_2015_df[4,i+2]/ig_tot_df_2[i,"total_demand"]
cal_gamma[i,"labour_gamma"] <- (prim_2015_df[5,i+2]*cal_gamma[i,"salary"])/(ig_tot_df_2[i,"total_demand"]*10^6)
}
cal_gamma
sala_name <- "Data/salary.csv"
sala_df <- read.csv(file= sala_name, stringsAsFactors = F)
cal_gamma <- data.frame("Sectors" = sectors,
"capital_gamma" = rep(0),
"labour_gamma" = rep(0))
cal_gamma <- cal_gamma %>%
left_join(sala_df, by = "Sectors")
for(i in 1:nrow(cal_gamma)){
cal_gamma[i,"capital_gamma"] <- prim_2015_df[4,i+2]/ig_tot_df_2[i,"total_demand"]
cal_gamma[i,"labour_gamma"] <- (prim_2015_df[5,i+2]*cal_gamma[i,"salary"])/(ig_tot_df_2[i,"total_demand"]*10^6)
}
cal_gamma
x_ij <- ig_tot_df_2 %>%
select(-Sectors, -total_demand)
rownames(x_ij) <- colnames(x_ij)
X_ij_b_ij <- x_ij
for(i in 1:nrow(X_ij_b_ij)){
for(j in 1:ncol(X_ij_b_ij)){
X_ij_b_ij[i,j] <- x_ij[i,j] ^ cal_beta[i,j]
}
}
cal_gamma_full <- cal_gamma %>%
mutate(capital = 0) %>%
mutate(labour = 0)
for(i in 1:nrow(cal_gamma_full)){
cal_gamma_full[i,"capital"] <- prim_2015_df[4,i+2]*10^6
cal_gamma_full[i,"labour"] <- prim_2015_df[5,i+2]
}
cal_gamma_full
cal_gamma_full_2 <- cal_gamma_full %>%
mutate(labour_cost = labour* salary)
cal_gamma_full_2
cal_gamma_full_2 <- cal_gamma_full %>%
mutate(labour_cost = labour* salary) %>%
mutate(capital_raised = capital ^ capital_gamma) %>%
mutate(labour_raised = labour_cost ^ labour_gamma)
cal_gamma_full_2
cal_a_j <-  data.frame("Sectors" = sectors,
"a_j" = rep(0))
for(i in 1:nrow(cal_a_j)){
cal_a_j[i,"a_j"] <- (ig_tot_df_2[i,"total_demand"]*10^6)/prod(X_ij_b_ij[,i], cal_gamma_full_2[,"capital_raised"],cal_gamma_full_2[,"labour_raised"])
}
cal_a_j
cal_gamma_full_2
m_bar <- sum(cal_gamma_full_2[,"labour_cost"])
m_bar
ig_tot_df_2
ig_sum_df_2
ig_sum_df
demand_hh_df<- ig_sum_df %>%
select(Sector, Households)
demand_hh_df
demand_hh_df<- ig_sum_df %>%
select(Sector, Households) %>%
mutate(alph_i = Households/sum(Households))
demand_hh_df
demand_hh_df<- ig_sum_df %>%
select(Sector, Households) %>%
mutate(alph_i = Households/sum(Households)) %>%
mutate(a_c = sum(Households)/prod(Households^alph_i))
demand_hh_df
function_delta_c_i(beta,price,output,salary,labour,capital,saving){
function_delta_c_i(beta,price,output,salary,labour,capital,saving){
function_delta_c_i <- function(beta,price,output,salary,labour,capital,saving){
delta_c <- rep(0,length(sectors))
return(delta_c)
}
test <- function_delta_c_i()
test
cal_beta
prices_test <- rep(1,length(sectors))
cal_beta
function_delta_c_i <- function(beta,price,output,salary,labour,capital,saving){
delta_c <- rep(0,length(sectors))
for(i in 1:length(sectors)){
for (j in 1:nrow(beta)) {
delta_c[i]  <- delta_c[i] +   ( beta[i,j]*price[j]*output[j])
}
}
return(delta_c)
}
output_amounts <- ig_tot_df_2[i,"total_demand"]
output_amounts
output_amounts <- ig_tot_df_2[,"total_demand"]
output_amounts
output_amounts <- ig_tot_df_2[,"total_demand"]*10^6
output_amounts
function_delta_c_i <- function(beta,price,output,salary,labour,capital,saving){
delta_c <- rep(0,length(sectors))
for(i in 1:length(sectors)){
for (j in 1:nrow(beta)) {
delta_c[i]  <- delta_c[i] +   ( beta[i,j]*price[j]*output[j])
}
}
return(delta_c)
}
prices_test <- rep(1,length(sectors))
output_amounts <- ig_tot_df_2[,"total_demand"]*10^6
test <- function_delta_c_i(beta = cal_beta,price = prices_test,output = output_amounts)
test
cal_gamma_full_2
output_test <- ig_tot_df_2[,"total_demand"]*10^6
labour_test <- cal_gamma_full_2[,"labour"]
labour_test
salary_test <- cal_gamma_full_2[,"salary"]
function_delta_c_i <- function(beta,price,output,salary,labour,capital,saving){
delta_c <- rep(0,length(sectors))
## step 1
for(i in 1:length(sectors)){
for (j in 1:nrow(beta)) {
delta_c[i]  <- delta_c[i] +   ( beta[i,j]*price[j]*output[j])
}
}
## step 2
temp_primary_factor_df <- data.frame("labour" = labour,
"Salary" = salary) %>%
mutate(labour_cost = labour * salary)
return(delta_c)
}
prices_test <- rep(1,length(sectors))
output_test <- ig_tot_df_2[,"total_demand"]*10^6
labour_test <- cal_gamma_full_2[,"labour"]
salary_test <- cal_gamma_full_2[,"salary"]
test <- function_delta_c_i(beta = cal_beta,
price = prices_test,
output = output_test,
labour = labour_test,
salary = salary_test)
test
demand_hh_df
alpha_test <- demand_hh_df[,"alph_i"]
alpha_test
function_delta_c_i <- function(alpha, beta, price, output, salary, labour, capital, saving){
delta_c <- rep(0,length(sectors))
## step 1
for(i in 1:length(sectors)){
for (j in 1:nrow(beta)) {
delta_c[i]  <- delta_c[i] +   ( beta[i,j]*price[j]*output[j])
}
}
## step 2
temp_primary_factor_df <- data.frame("labour" = labour,
"Salary" = salary) %>%
mutate(labour_cost = labour * salary)
temp_primary_tot <- sum(temp_primary_factor_df[,"labour_cost"])
for(i in 1:length(sectors)){
delta_c[i]  <- delta_c[i] + alpha[i]*temp_primary_tot
}
return(delta_c)
}
prices_test <- rep(1,length(sectors))
output_test <- ig_tot_df_2[,"total_demand"]*10^6
labour_test <- cal_gamma_full_2[,"labour"]
salary_test <- cal_gamma_full_2[,"salary"]
alpha_test <- demand_hh_df[,"alph_i"]
test <- function_delta_c_i(alpha = alpha_test,
beta = cal_beta,
price = prices_test,
output = output_test,
labour = labour_test,
salary = salary_test)
test
function_delta_c_i <- function(alpha, beta, price, output, salary, labour, capital, saving){
delta_c <- rep(0,length(sectors))
## step 1
for(i in 1:length(sectors)){
for (j in 1:nrow(beta)) {
delta_c[i]  <- delta_c[i] +   ( beta[i,j]*price[j]*output[j])
}
}
## step 2
temp_primary_factor_df <- data.frame("labour" = labour,
"Salary" = salary) %>%
mutate(labour_cost = labour * salary)
temp_primary_tot <- sum(temp_primary_factor_df[,"labour_cost"])
for(i in 1:length(sectors)){
delta_c[i]  <- delta_c[i] + alpha[i]*temp_primary_tot
}
## step 3
for(i in 1:length(sectors)){
delta_c[i]  <- delta_c[i] - (price[i]*output[i])
}
return(delta_c)
}
prices_test <- rep(1,length(sectors))
output_test <- ig_tot_df_2[,"total_demand"]*10^6
labour_test <- cal_gamma_full_2[,"labour"]
salary_test <- cal_gamma_full_2[,"salary"]
alpha_test <- demand_hh_df[,"alph_i"]
test <- function_delta_c_i(alpha = alpha_test,
beta = cal_beta,
price = prices_test,
output = output_test,
labour = labour_test,
salary = salary_test)
test
cal_gamma_full_2
source("F:/My Drive/EMAP/101 Dissertation/Dissertation/R Model/03_Calibration_v1.R", echo=TRUE)
cal_gamma_full_2 <- cal_gamma_full %>%
mutate(labour_cost = labour* salary) %>%
mutate(capital_price = Interst_rate) %>%
mutate( capital_cost = capital_price*capital) %>%
mutate(capital_raised = capital ^ capital_gamma) %>%
mutate(labour_raised = labour_cost ^ labour_gamma)
Interst_rate <- 0.02
cal_gamma_full_2 <- cal_gamma_full %>%
mutate(labour_cost = labour* salary) %>%
mutate(capital_price = Interst_rate) %>%
mutate( capital_cost = capital_price*capital) %>%
mutate(capital_raised = capital ^ capital_gamma) %>%
mutate(labour_raised = labour_cost ^ labour_gamma)
cal_gamma_full_2
prim_2015_df <- prim_df %>%
filter(Year == 2015)
cal_gamma <- data.frame("Sectors" = sectors,
"capital_gamma" = rep(0),
"labour_gamma" = rep(0))
cal_gamma <- cal_gamma %>%
left_join(sala_df, by = "Sectors") %>%
mutate(capital_price = Interst_rate) %>%
mutate( capital_cost = capital_price*capital)
cal_gamma <- data.frame("Sectors" = sectors,
"capital_gamma" = rep(0),
"labour_gamma" = rep(0)) %>%
left_join(sala_df, by = "Sectors") %>%
mutate(capital_price = Interst_rate) %>%
mutate( capital_cost = 0)  %>%
mutate(capital = 0) %>%
mutate(labour = 0)
cal_gamma_full <- cal_gamma
prim_2015_df <- prim_df %>%
filter(Year == 2015)
cal_gamma <- data.frame("Sectors" = sectors,
"capital_gamma" = rep(0),
"labour_gamma" = rep(0)) %>%
left_join(sala_df, by = "Sectors") %>%
mutate(capital_price = Interst_rate) %>%
mutate( capital_cost = 0)  %>%
mutate(capital = 0) %>%
mutate(labour = 0)
cal_gamma_full <- cal_gamma
for(i in 1:nrow(cal_gamma_full)){
cal_gamma_full[i,"capital"] <- prim_2015_df[4,i+2]*10^6
cal_gamma_full[i,"labour"] <- prim_2015_df[5,i+2]
cal_gamma_full[i,"capital_cost"] <- cal_gamma_full[i,"capital"]*cal_gamma_full[i,"capital_price"]
}
cal_gamma_full
cal_gamma <- data.frame("Sectors" = sectors,
"capital_gamma" = rep(0),
"labour_gamma" = rep(0)) %>%
left_join(sala_df, by = "Sectors") %>%
mutate(capital_price = Interst_rate) %>%
mutate( capital_cost = 0)  %>%
mutate(capital = 0) %>%
mutate(labour = 0) %>%
mutate(labour_cost = 0)
cal_gamma_full <- cal_gamma
for(i in 1:nrow(cal_gamma_full)){
cal_gamma_full[i,"capital"] <- prim_2015_df[4,i+2]*10^6
cal_gamma_full[i,"labour"] <- prim_2015_df[5,i+2]
cal_gamma_full[i,"capital_cost"] <- cal_gamma_full[i,"capital"]*cal_gamma_full[i,"capital_price"]
cal_gamma_full[i,"labour_cost"] <- cal_gamma_full[i,"labour"]*cal_gamma_full[i,"salary"]
}
cal_gamma <- data.frame("Sectors" = sectors,
"capital_gamma" = rep(0),
"labour_gamma" = rep(0)) %>%
left_join(sala_df, by = "Sectors") %>%
mutate(capital_price = Interst_rate) %>%
mutate( capital_cost = 0)  %>%
mutate(capital = 0) %>%
mutate(labour = 0) %>%
mutate(labour_cost = 0)
cal_gamma_full <- cal_gamma
for(i in 1:nrow(cal_gamma_full)){
cal_gamma_full[i,"capital"] <- prim_2015_df[4,i+2]*10^6
cal_gamma_full[i,"labour"] <- prim_2015_df[5,i+2]
cal_gamma_full[i,"capital_cost"] <- cal_gamma_full[i,"capital"]*cal_gamma_full[i,"capital_price"]
cal_gamma_full[i,"labour_cost"] <- cal_gamma_full[i,"labour"]*cal_gamma_full[i,"salary"]
}
for(i in 1:nrow(cal_gamma)){
cal_gamma[i,"capital_gamma"] <- cal_gamma_full[i,"capital_cost"]/(ig_tot_df_2[i,"total_demand"]*10^6)
cal_gamma[i,"labour_gamma"] <- cal_gamma_full[i,"labour_cost"]/(ig_tot_df_2[i,"total_demand"]*10^6)
}
cal_gamma_full_2 <- cal_gamma_full %>%
mutate(capital_raised = capital ^ capital_gamma) %>%
mutate(labour_raised = labour_cost ^ labour_gamma)
cal_gamma_full_2 <- cal_gamma_full %>%
mutate(capital_raised = capital_cost ^ capital_gamma) %>%
mutate(labour_raised = labour_cost ^ labour_gamma)
cal_a_j <-  data.frame("Sectors" = sectors,
"a_j" = rep(0))
for(i in 1:nrow(cal_a_j)){
cal_a_j[i,"a_j"] <- (ig_tot_df_2[i,"total_demand"]*10^6)/prod(X_ij_b_ij[,i], cal_gamma_full_2[,"capital_raised"],cal_gamma_full_2[,"labour_raised"])
}
m_bar <- sum(cal_gamma_full_2[,"labour_cost"]) + sum(cal_gamma_full_2[,"capital_cost"])
cal_gamma_full_2
capital_test <- cal_gamma_full_2[,"capital"]
function_delta_c_i <- function(alpha, beta, price, output, salary, labour, capital, saving, interest_rate){
delta_c <- rep(0,length(sectors))
## step 1
for(i in 1:length(sectors)){
for (j in 1:nrow(beta)) {
delta_c[i]  <- delta_c[i] +   ( beta[i,j]*price[j]*output[j])
}
}
## step 2
temp_primary_factor_df <- data.frame("labour" = labour,
"Salary" = salary,
"capital" = capital,
"capital_price" = rep(interest_rate)) %>%
mutate(labour_cost = labour * salary) %>%
mutate(capital_cost = capital * interest_rate)
temp_primary_tot_1 <- sum(temp_primary_factor_df[,"labour_cost"])
temp_primary_tot_2 <- sum(temp_primary_factor_df[,"capital_cost"])
temp_primary_tot <- temp_primary_tot_1 + temp_primary_tot_2
for(i in 1:length(sectors)){
delta_c[i]  <- delta_c[i] + alpha[i]*temp_primary_tot
}
## step 3
for(i in 1:length(sectors)){
delta_c[i]  <- delta_c[i] - (price[i]*output[i])
}
return(delta_c)
}
prices_test <- rep(1,length(sectors))
output_test <- ig_tot_df_2[,"total_demand"]*10^6
labour_test <- cal_gamma_full_2[,"labour"]
salary_test <- cal_gamma_full_2[,"salary"]
alpha_test <- demand_hh_df[,"alph_i"]
capital_test <- cal_gamma_full_2[,"capital"]
test <- function_delta_c_i(alpha = alpha_test,
beta = cal_beta,
price = prices_test,
output = output_test,
labour = labour_test,
salary = salary_test,
capital = capital_test)
test <- function_delta_c_i(alpha = alpha_test,
beta = cal_beta,
price = prices_test,
output = output_test,
labour = labour_test,
salary = salary_test,
capital = capital_test,
interest_rate = Interst_rate)
test
function_delta_c_i <- function(alpha, beta, price, output, salary, labour, capital, saving, interest_rate){
delta_c <- rep(0,length(sectors))
## step 1
for(i in 1:length(sectors)){
for (j in 1:nrow(beta)) {
delta_c[i]  <- delta_c[i] +   ( beta[j,i]*price[j]*output[j])
}
}
## step 2
temp_primary_factor_df <- data.frame("labour" = labour,
"Salary" = salary,
"capital" = capital,
"capital_price" = rep(interest_rate)) %>%
mutate(labour_cost = labour * salary) %>%
mutate(capital_cost = capital * interest_rate)
temp_primary_tot_1 <- sum(temp_primary_factor_df[,"labour_cost"])
temp_primary_tot_2 <- sum(temp_primary_factor_df[,"capital_cost"])
temp_primary_tot <- temp_primary_tot_1 + temp_primary_tot_2
for(i in 1:length(sectors)){
delta_c[i]  <- delta_c[i] + alpha[i]*temp_primary_tot
}
## step 3
for(i in 1:length(sectors)){
delta_c[i]  <- delta_c[i] - (price[i]*output[i])
}
return(delta_c)
}
prices_test <- rep(1,length(sectors))
output_test <- ig_tot_df_2[,"total_demand"]*10^6
labour_test <- cal_gamma_full_2[,"labour"]
salary_test <- cal_gamma_full_2[,"salary"]
alpha_test <- demand_hh_df[,"alph_i"]
capital_test <- cal_gamma_full_2[,"capital"]
test <- function_delta_c_i(alpha = alpha_test,
beta = cal_beta,
price = prices_test,
output = output_test,
labour = labour_test,
salary = salary_test,
capital = capital_test,
interest_rate = Interst_rate)
test
cal_gamma_full_2
for(i in 1:nrow(cal_gamma)){
cal_gamma_full[i,"capital_gamma"] <- cal_gamma_full[i,"capital_cost"]/(ig_tot_df_2[i,"total_demand"]*10^6)
cal_gamma_full[i,"labour_gamma"] <- cal_gamma_full[i,"labour_cost"]/(ig_tot_df_2[i,"total_demand"]*10^6)
}
cal_gamma_full_2 <- cal_gamma_full %>%
mutate(capital_raised = capital_cost ^ capital_gamma) %>%
mutate(labour_raised = labour_cost ^ labour_gamma)
cal_a_j <-  data.frame("Sectors" = sectors,
"a_j" = rep(0))
for(i in 1:nrow(cal_a_j)){
cal_a_j[i,"a_j"] <- (ig_tot_df_2[i,"total_demand"]*10^6)/prod(X_ij_b_ij[,i], cal_gamma_full_2[,"capital_raised"],cal_gamma_full_2[,"labour_raised"])
}
cal_gamma_full_2
gamma_test <- cal_gamma_full_2
gamma_test <- cal_gamma_full_2[,c("capital_gamma","labour_gamma")]
gamma_test
