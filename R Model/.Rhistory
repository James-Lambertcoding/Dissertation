test_pi
ig_tot_df_2
x_ij
test_prod <- c(1,2,3,4)
prod(test_prod)
cal_gamma_2 <- cal_gamma %>%
mutate(capital_raised = capital_cost ^ capital_gamma) %>%
mutate(labour_raised = labour_cost ^ labour_gamma)
cal_a_j <-  data.frame("Sectors" = sectors,
"a_j" = rep(0))
for(i in 1:nrow(cal_a_j)){
cal_a_j[i,"a_j"] <- (cal_gamma_2[i,"total_supply"])/prod(X_ij_b_ij[j,], cal_gamma_2[i,"capital_raised"],cal_gamma_2[i,"labour_raised"])
}
function_delta_pi_j <- function(price, A_j, beta, gamma_capital, gamma_labour, primary_costs){
delta_pi <- rep(0, length(sectors))
## first part
delta_pi[j] <- price[j]
## second part
step_1_list <- list()
## third part
step_2_df <- data.frame("gamma_capital" = gamma_capital,
"gamma_labour" = gamma_labour) %>%
mutate(capial_price = primary_costs[,"capital_price"]) %>%
mutate(labour_price = primary_costs[,"labour_price"]) %>%
mutate(w_g_g1 = (capial_price/gamma_capital)^gamma_capital) %>%
mutate(w_g_g2 = (labour_price/gamma_labour)^gamma_labour) %>%
mutate(step_2_j = w_g_g1 * w_g_g2)
for(j in 1:length(sectors)){
step_1_list[[j]] <- beta %>%
mutate(prices = price)
step_1_list[[j]] <- step_1_list[[j]][,c(j,ncol(step_1_list[[j]]))]
colnames(step_1_list[[j]])[1] <- "beta_j"
step_1_list[[j]] <- step_1_list[[j]] %>%
##p_b_b = price/ beta raised to beta
mutate(p_b_b = (price/beta_j)^beta_j)
delta_pi[j] <- delta_pi[j] - A_j[j]*prod(step_1_list[[j]][,"p_b_b"])*step_2_df[j,"step_2_j"]
}
#return(step_2_df)
return(delta_pi)
}
test_pi <- function_delta_pi_j(price = prices_test,
A_j = Aj_test,
beta = beta_test,
primary_costs = primary_price_test,
gamma_capital =  gamma_capital_test,
gamma_labour = gamma_labour_test)
test_pi
cal_gamma_2
cal_a_j <-  data.frame("Sectors" = sectors,
"a_j" = rep(0))
for(i in 1:nrow(cal_a_j)){
cal_a_j[i,"a_j"] <- (cal_gamma_2[i,"total_supply"])/prod(X_ij_b_ij[i,], cal_gamma_2[i,"capital_raised"],cal_gamma_2[i,"labour_raised"])
}
prices_test <- rep(1,length(sectors))
capital_price_test <- rep(Interest_rate,length(sectors))
output_test <- cal_gamma_2[,"total_supply"]
labour_test <- cal_gamma_2[,"labour"]
salary_test <- cal_gamma_2[,"salary"]
primary_price_test <- data.frame("capital_price" = capital_price_test,
"labour_price" = salary_test)
alpha_test <- cal_HH_utl[,"alpha_i"]
capital_test <- cal_gamma_2[,"capital"]
gamma_capital_test <- cal_gamma_2[,"capital_gamma"]
gamma_labour_test <- cal_gamma_2[,"labour_gamma"]
gamma_test <- cal_gamma_2[,c("capital_gamma","labour_gamma")]
m_test <- m_bar
vj_test <- cal_vj_bar[,"vj_bar"]
Aj_test <- cal_a_j[,"a_j"]
beta_test <- cal_beta
test_pi <- function_delta_pi_j(price = prices_test,
A_j = Aj_test,
beta = beta_test,
primary_costs = primary_price_test,
gamma_capital =  gamma_capital_test,
gamma_labour = gamma_labour_test)
test_pi
cal_a_j
for(i in 1:nrow(cal_a_j)){
cal_a_j[i,"a_j"] <- (cal_gamma_2[i,"total_supply"])/prod(X_ij_b_ij[,i], cal_gamma_2[i,"capital_raised"],cal_gamma_2[i,"labour_raised"])
}
Aj_test <- cal_a_j[,"a_j"]
test_pi <- function_delta_pi_j(price = prices_test,
A_j = Aj_test,
beta = beta_test,
primary_costs = primary_price_test,
gamma_capital =  gamma_capital_test,
gamma_labour = gamma_labour_test)
test_pi
cal_gamma <- cal_gamma %>%
mutate(total_supply = ig_sum_df_temp_2[,"total_supply"]) %>%
mutate(labour_gamma_2 = 0) %>%
mutate(capital_gamma_2 = 0)
## this needs to change
for(i in 1:nrow(cal_gamma)){
cal_gamma[i,"capital_gamma"] <- cal_gamma[i,"capital_cost"]/cal_gamma[i,"total_supply"]
cal_gamma[i,"labour_gamma"] <- cal_gamma[i,"labour_cost"]/cal_gamma[i,"total_supply"]
cal_gamma[i,"capital_gamma_2"] <- cal_gamma[i,"capital"]/cal_gamma[i,"total_supply"]
cal_gamma[i,"labour_gamma_2"] <- cal_gamma[i,"labour"]/cal_gamma[i,"total_supply"]
}
cal_gamma
iot_simple <- data.frame("x.1" = c(0,0,0),
"x.2" = c(10,0,0),
"x.3" = c(10,0,0))
iot_simple <- data.frame("x.1" = c(0,0,0),
"x.2" = c(10,0,0),
"x.3" = c(10,0,0),
"final_demand" = c(100,100,100))
iot_simple <- data.frame("x.1" = c(0,0,0),
"x.2" = c(10,0,0),
"x.3" = c(10,0,0),
"final_demand" = c(100,100,100),
"labour" = c(40,20,20),
"salary" = c(1,1,1)) %>%
mutate(int_demand = x.1 + x.2 +x.3)
iot_simple
iot_simple <- data.frame("x.1" = c(0,0,0),
"x.2" = c(10,0,0),
"x.3" = c(10,0,0),
"final_demand" = c(100,100,100),
"labour" = c(40,20,20),
"salary" = c(1,1,1)) %>%
mutate(int_demand = x.1 + x.2 +x.3) %>%
mutate(total_demand = final_demand + int_demand)
cal_iot_simple <- iot_simple %>%
mutate(alphi_i = final_demand/sum(final_demand)) %>%
mutate(gi_ai = final_demand^alpha_i) %>%
mutate(A_c = sum(final_demand)/prod(gi_ai))
iot_simple <- data.frame("x.1" = c(0,0,0),
"x.2" = c(10,0,0),
"x.3" = c(10,0,0),
"final_demand" = c(100,100,100),
"labour" = c(40,20,20),
"salary" = c(1,1,1)) %>%
mutate(int_demand = x.1 + x.2 +x.3) %>%
mutate(total_demand = final_demand + int_demand)
cal_iot_simple <- iot_simple %>%
mutate(alpha_i = final_demand/sum(final_demand)) %>%
mutate(gi_ai = final_demand^alpha_i) %>%
mutate(A_c = sum(final_demand)/prod(gi_ai))
cal_iot_simple
cal_iot_simple <- iot_simple %>%
mutate(alpha_i = final_demand/sum(final_demand)) %>%
mutate(gi_ai = final_demand^alpha_i) %>%
mutate(A_c = sum(final_demand)/prod(gi_ai)) %>%
mutate(b_x1 = x.1/total_demand)
cal_iot_simple
cal_iot_simple <- iot_simple %>%
mutate(alpha_i = final_demand/sum(final_demand)) %>%
mutate(gi_ai = final_demand^alpha_i) %>%
mutate(A_c = sum(final_demand)/prod(gi_ai)) %>%
mutate(b_x1 = x.1/total_demand) %>%
mutate(b_x2 = x.2/total_demand) %>%
mutate(b_x3 = x.3/total_demand)
cal_iot_simple <- iot_simple %>%
mutate(alpha_i = final_demand/sum(final_demand)) %>%
mutate(gi_ai = final_demand^alpha_i) %>%
mutate(A_c = sum(final_demand)/prod(gi_ai)) %>%
mutate(b_x1 = x.1/total_demand) %>%
mutate(b_x2 = x.2/total_demand) %>%
mutate(b_x3 = x.3/total_demand) %>%
mutate(gamma_j = labour/total_demand)
cal_iot_simple
cal_iot_simple <- iot_simple %>%
mutate(alpha_i = final_demand/sum(final_demand)) %>%
mutate(gi_ai = final_demand^alpha_i) %>%
mutate(A_c = sum(final_demand)/prod(gi_ai)) %>%
mutate(b_x1 = x.1/total_demand) %>%
mutate(b_x2 = x.2/total_demand) %>%
mutate(b_x3 = x.3/total_demand) %>%
mutate(gamma_j = labour/total_demand) %>%
mutate(xj_bj1 = x.1^b_x1 ) %>%
mutate(xj_bj2 = x.2^b_x2 ) %>%
mutate(xj_bj3 = x.3^b_x3 )
cal_iot_simple
cal_iot_simple <- iot_simple %>%
mutate(alpha_i = final_demand/sum(final_demand)) %>%
mutate(gi_ai = final_demand^alpha_i) %>%
mutate(A_c = sum(final_demand)/prod(gi_ai)) %>%
mutate(b_x1 = x.1/total_demand) %>%
mutate(b_x2 = x.2/total_demand) %>%
mutate(b_x3 = x.3/total_demand) %>%
mutate(gamma_j = labour/total_demand) %>%
mutate(xj_bj1 = x.1^b_x1 ) %>%
mutate(xj_bj2 = x.2^b_x2 ) %>%
mutate(xj_bj3 = x.3^b_x3 ) %>%
mutate(labour_gamma = labour^gamma_j)
cal_iot_simple <- iot_simple %>%
mutate(alpha_i = final_demand/sum(final_demand)) %>%
mutate(gi_ai = final_demand^alpha_i) %>%
mutate(A_c = sum(final_demand)/prod(gi_ai)) %>%
mutate(b_x1 = x.1/total_demand) %>%
mutate(b_x2 = x.2/total_demand) %>%
mutate(b_x3 = x.3/total_demand) %>%
mutate(gamma_j = labour/total_demand) %>%
mutate(xj_bj1 = x.1^b_x1 ) %>%
mutate(xj_bj2 = x.2^b_x2 ) %>%
mutate(xj_bj3 = x.3^b_x3 ) %>%
mutate(labour_gamma = labour^gamma_j) %>%
mutate(a_j = total_demand)
cal_iot_simple
cal_iot_simple[1,"a_j"] <- prod(cal_iot_simple[,"xj_bj1"])
cal_iot_simple
cal_iot_simple[1,"a_j"] <- cal_iot_simple[1,"total_demand"] /(prod(cal_iot_simple[,"xj_bj1"]) * cal_iot_simple[1,"labour_gamma "])
(prod(cal_iot_simple[,"xj_bj1"])
)
(prod(cal_iot_simple[,"xj_bj1"]) * cal_iot_simple[1,"labour_gamma "])
cal_iot_simple[1,"a_j"] <- cal_iot_simple[1,"total_demand"] /(prod(cal_iot_simple[,"xj_bj1"]) * cal_iot_simple[1,"labour_gamma"])
cal_iot_simple
cal_iot_simple[1,"a_j"] <- cal_iot_simple[1,"total_demand"] /(prod(cal_iot_simple[,"xj_bj1"]) * cal_iot_simple[1,"labour_gamma"])
cal_iot_simple[2,"a_j"] <- cal_iot_simple[2,"total_demand"] /(prod(cal_iot_simple[,"xj_bj2"]) * cal_iot_simple[2,"labour_gamma"])
cal_iot_simple[3,"a_j"] <- cal_iot_simple[3,"total_demand"] /(prod(cal_iot_simple[,"xj_bj3"]) * cal_iot_simple[3,"labour_gamma"])
cal_iot_simple
iot_simple <- data.frame("x.1" = c(0,0,0),
"x.2" = c(2,0,0),
"x.3" = c(2,0,0),
"final_demand" = c(40,20,20),
"labour" = c(40,20,20),
"salary" = c(1,1,1)) %>%
mutate(int_demand = x.1 + x.2 +x.3) %>%
mutate(total_demand = final_demand + int_demand)
cal_iot_simple <- iot_simple %>%
mutate(alpha_i = final_demand/sum(final_demand)) %>%
mutate(gi_ai = final_demand^alpha_i) %>%
mutate(A_c = sum(final_demand)/prod(gi_ai)) %>%
mutate(b_x1 = x.1/total_demand) %>%
mutate(b_x2 = x.2/total_demand) %>%
mutate(b_x3 = x.3/total_demand) %>%
mutate(gamma_j = labour/total_demand) %>%
mutate(xj_bj1 = x.1^b_x1 ) %>%
mutate(xj_bj2 = x.2^b_x2 ) %>%
mutate(xj_bj3 = x.3^b_x3 ) %>%
mutate(labour_gamma = labour^gamma_j) %>%
mutate(a_j = total_demand)
cal_iot_simple[1,"a_j"] <- cal_iot_simple[1,"total_demand"] /(prod(cal_iot_simple[,"xj_bj1"]) * cal_iot_simple[1,"labour_gamma"])
cal_iot_simple[2,"a_j"] <- cal_iot_simple[2,"total_demand"] /(prod(cal_iot_simple[,"xj_bj2"]) * cal_iot_simple[2,"labour_gamma"])
cal_iot_simple[3,"a_j"] <- cal_iot_simple[3,"total_demand"] /(prod(cal_iot_simple[,"xj_bj3"]) * cal_iot_simple[3,"labour_gamma"])
cal_iot_simple
prim_2015_df <- prim_df %>%
filter(Year == 2015)
cal_gamma <- data.frame("Sectors" = sectors,
"capital_gamma" = rep(0),
"labour_gamma" = rep(0)) %>%
left_join(sala_df, by = "Sectors") %>%
mutate(capital_price = Interst_rate) %>%
mutate( capital_cost = 0)  %>%
mutate(capital = 0) %>%
mutate(labour = 0) %>%
mutate(labour_cost = 0)
prim_2015_df <- prim_df %>%
filter(Year == 2015)
cal_gamma <- data.frame("Sectors" = sectors,
"capital_gamma" = rep(0),
"labour_gamma" = rep(0)) %>%
left_join(sala_df, by = "Sectors") %>%
mutate(capital_price = Interst_rate) %>%
mutate( capital_cost = 0)  %>%
mutate(capital = 0) %>%
mutate(labour = 0) %>%
mutate(labour_cost = 0)
for(i in 1:nrow(cal_gamma)){
cal_gamma[i,"capital"] <- prim_2015_df[4,i+2]*10^6
cal_gamma[i,"labour"] <- prim_2015_df[5,i+2]
cal_gamma[i,"capital_cost"] <- cal_gamma[i,"capital"]*cal_gamma[i,"capital_price"]
cal_gamma[i,"labour_cost"] <- cal_gamma[i,"labour"]*cal_gamma[i,"salary"]
}
m_bar <- sum(cal_gamma[,"capital_cost"])+sum(cal_gamma[,"labour_cost"])
ig_sum_df_temp <- ig_sum_df %>%
select(Sector, Households) %>%
rename(sectors = Sector) %>%
mutate(ratio = Households/sum(Households)) %>%
mutate(total_exp = m_bar) %>%
mutate(HH_exp = ratio*total_exp)
ig_sum_df_temp
ig_tot_df_temp <- ig_tot_df %>%
select(-Sectors)
rownames(ig_tot_df_temp) <- colnames(ig_tot_df_temp)
ig_tot_df_temp <- ig_tot_df_temp %>%
mutate(in_tot = 0)
ig_tot_df_temp
ig_tot_df_temp <- ig_tot_df_temp %>%
mutate(in_tot = 0)
for(i in 1:nrow(ig_tot_df_temp)){
ig_tot_df_temp[i, "in_tot"] <- sum(ig_tot_df_temp[i,1:(ncol(ig_tot_df_temp)-1)])
}
ig_sum_df_temp_2 <- ig_sum_df_temp %>%
mutate(in_tot = ig_tot_df_temp[, "in_tot"]* 10^6) %>%
mutate(total_supply = HH_exp+in_tot)
ig_sum_df_temp_2
prim_2015_df <- prim_df %>%
filter(Year == 2015)
cal_gamma <- data.frame("Sectors" = sectors,
"capital_gamma" = rep(0),
"labour_gamma" = rep(0)) %>%
left_join(sala_df, by = "Sectors") %>%
mutate(capital_price = Interst_rate) %>%
mutate( capital_cost = 0)  %>%
mutate(capital = 0) %>%
mutate(labour = 0) %>%
mutate(labour_cost = 0)
for(i in 1:nrow(cal_gamma)){
cal_gamma[i,"capital"] <- prim_2015_df[4,i+2]*10^6
cal_gamma[i,"labour"] <- prim_2015_df[5,i+2]
cal_gamma[i,"capital_cost"] <- cal_gamma[i,"capital"]*cal_gamma[i,"capital_price"]
cal_gamma[i,"labour_cost"] <- cal_gamma[i,"labour"]*cal_gamma[i,"salary"]
}
cal_gamma
m_bar <- sum(cal_gamma[,"capital_cost"])+sum(cal_gamma[,"labour_cost"])
ig_tot_df_temp <- ig_tot_df_temp %>%
mutate(in_tot = 0)
for(i in 1:nrow(ig_tot_df_temp)){
ig_tot_df_temp[i, "in_tot"] <- sum(ig_tot_df_temp[i,1:(ncol(ig_tot_df_temp)-1)])
}
ig_tot_df_temp
ig_tot_total <- sum(ig_tot_df_temp[, "in_tot"])
ig_tot_total
ig_tot_total <- sum(ig_tot_df_temp[, "in_tot"]) > m_bar
ig_tot_total
ig_tot_total <- sum(ig_tot_df_temp[, "in_tot"])
ig_tot_total
ig_tot_total <- sum(ig_tot_df_temp[, "in_tot"]) *10^6
ig_sum_df_temp_2 <- ig_sum_df_temp %>%
mutate(in_tot = ig_tot_df_temp[, "in_tot"]* 10^6) %>%
mutate(in_tot_total = ig_tot_total)
ig_sum_df_temp_2
cal_gamma
m_bar
m_bar > ig_tot_total
ig_tot_total
cal_gamma_2[,"salary"]
sum(cal_gamma_2[,"salary"])
sum(cal_gamma_2[,"labour"])
ig_sum_df_temp
ig_sum_df
ig_sum_df_3 < ig_sum_df
ig_sum_df_3 < ig_sum_df
ig_sum_df_3 <- ig_sum_df
colnames(ig_sum_df_3) <- c("Sectors",
"Int_total",
"Households",
"Government",
"Capital_increase",
"Total_demand")
ig_sum_df_3
ig_sum_df_temp <- ig_sum_df %>%
select(Sector, Households) %>%
rename(sectors = Sector) %>%
mutate(ratio = Households/sum(Households)) %>%
mutate(int_total = ig_sum_df_3[,"Int_total"])
ig_sum_df_temp
ig_sum_df_temp <- ig_sum_df %>%
select(Sector, Households) %>%
rename(sectors = Sector) %>%
mutate(ratio = Households/sum(Households)) %>%
mutate(int_total = ig_sum_df_3[,"Int_total"]*10^6)
sum(ig_sum_df_temp[,"int_total"])
sum(ig_sum_df_temp[,"int_total"]) > m_bar
sum(ig_sum_df_temp[,"int_total"])
m_bar
m_bar/sum(ig_sum_df_temp[,"int_total"])
ig_sum_name <- "Data/IG_summary_2015.csv"
ig_sum_df <- read.csv(file= ig_sum_name, stringsAsFactors = F)
ig_sum_df
ig_sum_name <- "Data/IG_summary_2015.csv"
ig_sum_df <- read.csv(file= ig_sum_name, stringsAsFactors = F)
ig_sum_df
colnames(ig_sum_df_3) <- c("Sectors",
"Int_total",
"Households",
"Government",
"Capital_increase",
"Total_demand",
"Exports")
ig_sum_df_3 <- ig_sum_df
colnames(ig_sum_df_3) <- c("Sectors",
"Int_total",
"Households",
"Government",
"Capital_increase",
"Total_demand",
"Exports")
ig_sum_df_3
ig_sum_df_4 <- ig_sum_df_3 %>%
mutate(export_ratio = exports/Total_demand)
ig_sum_df_4 <- ig_sum_df_3 %>%
mutate(export_ratio = Exports/Total_demand)
ig_sum_df_4
ig_tot_df
ig_tot_df
## Remove exports from ig_tot
ig_tot_aut_df <-ig_tot_df
## Remove exports from ig_tot
ig_tot_aut_df <-ig_tot_df
##aurtuky data frame
for(j in 2:ncol(ig_tot_aut_df)){
ig_tot_aut_df[,j] <- ig_tot_aut_df[,j]*(1-ig_sum_df_4[j-1,"export_ratio"])
}
ig_tot_aut_df
## Remove exports from ig_tot
ig_tot_aut_df <-ig_tot_df
##aurtuky data frame
for(j in 2:ncol(ig_tot_aut_df)){
ig_tot_aut_df[,j] <- ig_tot_aut_df[,j]*(1-ig_sum_df_4[j-1,"export_ratio"])
ig_tot_aut_df[,j] <- ig_tot_aut_df[,j] *10^6
}
ig_sum_df_4 <- ig_sum_df_3 %>%
mutate(export_ratio = Exports/Total_demand) %>%
mutate(new_int_good = 0)
for(i in 1:nrow(ig_sum_df_4)){
ig_sum_df_4[i,"new_int_good"] <- sum(ig_tot_aut_df[1,2:ncol(ig_tot_aut_df)])
}
ig_sum_df_4
for(i in 1:nrow(ig_sum_df_4)){
ig_sum_df_4[i,"new_int_good"] <- sum(ig_tot_aut_df[i,2:ncol(ig_tot_aut_df)])
}
ig_sum_df_4
aut_ig_total <- sum(ig_sum_df_4[,"new_int_good"])
aut_ig_total>m_bar
aut_ig_total
m_bar
prim_2015_df <- prim_df %>%
filter(Year == 2015)
prim_2015_df
Interest_rate <- 0.1
prim_2015_df <- prim_df %>%
filter(Year == 2015)
cal_gamma <- data.frame("Sectors" = sectors,
"capital_gamma" = rep(0),
"labour_gamma" = rep(0)) %>%
left_join(sala_df, by = "Sectors") %>%
mutate(capital_price = Interst_rate) %>%
mutate( capital_cost = 0)  %>%
mutate(capital = 0) %>%
mutate(labour = 0) %>%
mutate(labour_cost = 0)
for(i in 1:nrow(cal_gamma)){
cal_gamma[i,"capital"] <- prim_2015_df[4,i+2]*10^6
cal_gamma[i,"labour"] <- prim_2015_df[5,i+2]
cal_gamma[i,"capital_cost"] <- cal_gamma[i,"capital"]*cal_gamma[i,"capital_price"]
cal_gamma[i,"labour_cost"] <- cal_gamma[i,"labour"]*cal_gamma[i,"salary"]
}
m_bar <- sum(cal_gamma[,"capital_cost"])+sum(cal_gamma[,"labour_cost"])
m_bar
cal_gamma
cal_gamma <- data.frame("Sectors" = sectors,
"capital_gamma" = rep(0),
"labour_gamma" = rep(0)) %>%
left_join(sala_df, by = "Sectors") %>%
mutate(capital_price = Interest_rate) %>%
mutate( capital_cost = 0)  %>%
mutate(capital = 0) %>%
mutate(labour = 0) %>%
mutate(labour_cost = 0)
for(i in 1:nrow(cal_gamma)){
cal_gamma[i,"capital"] <- prim_2015_df[4,i+2]*10^6
cal_gamma[i,"labour"] <- prim_2015_df[5,i+2]
cal_gamma[i,"capital_cost"] <- cal_gamma[i,"capital"]*cal_gamma[i,"capital_price"]
cal_gamma[i,"labour_cost"] <- cal_gamma[i,"labour"]*cal_gamma[i,"salary"]
}
m_bar <- sum(cal_gamma[,"capital_cost"])+sum(cal_gamma[,"labour_cost"])
m_bar
aut_ig_total
aut_ig_total*10^-6
aut_ig_total>/28
aut_ig_total/28
(aut_ig_total*10^-6)/28
for(j in 2:ncol(prim_df)){
prim_df[,j] <- as.numeric(prim_df[,j])
}
prim_2015_df <- prim_df %>%
filter(Year == 2015)
cal_gamma <- data.frame("Sectors" = sectors,
"capital_gamma" = rep(0),
"labour_gamma" = rep(0)) %>%
left_join(sala_df, by = "Sectors") %>%
mutate(capital_price = Interest_rate) %>%
mutate( capital_cost = 0)  %>%
mutate(capital = 0) %>%
mutate(labour = 0) %>%
mutate(labour_cost = 0)
cal_gamma
for(i in 1:nrow(cal_gamma)){
cal_gamma[i,"capital"] <- prim_2015_df[4,i+2]*10^6
cal_gamma[i,"labour"] <- prim_2015_df[5,i+2]
cal_gamma[i,"capital_cost"] <- cal_gamma[i,"capital"]*cal_gamma[i,"capital_price"]
cal_gamma[i,"labour_cost"] <- cal_gamma[i,"labour"]*cal_gamma[i,"salary"]
}
sum(cal_gamma[,"labour"])
sum(cal_gamma[,"labour_cost"])
sum(cal_gamma[,"capital_cost])/sum(cal_gamma[,"labour_cost"])
sum(cal_gamma[,"capital_cost"])/sum(cal_gamma[,"labour_cost"])
sum(cal_gamma[,"labour_cost"])/sum(cal_gamma[,"labour"])
effective_tax <- 0.3
effective_tax <- 0.3
prim_2015_df <- prim_df %>%
filter(Year == 2015)
cal_gamma <- data.frame("Sectors" = sectors,
"capital_gamma" = rep(0),
"labour_gamma" = rep(0)) %>%
left_join(sala_df, by = "Sectors") %>%
mutate(capital_price = Interest_rate) %>%
mutate( capital_cost = 0)  %>%
mutate(capital = 0) %>%
mutate(labour = 0) %>%
mutate(labour_cost = 0)
for(i in 1:nrow(cal_gamma)){
cal_gamma[i,"capital"] <- prim_2015_df[4,i+2]*10^6
cal_gamma[i,"labour"] <- prim_2015_df[5,i+2]
cal_gamma[i,"labour"] <- cal_gamma[i,"labour"] /(1-effective_tax)
cal_gamma[i,"capital_cost"] <- cal_gamma[i,"capital"]*cal_gamma[i,"capital_price"]
cal_gamma[i,"labour_cost"] <- cal_gamma[i,"labour"]*cal_gamma[i,"salary"]
}
cal_gamma
