price_reg[[i]] <- lm(Spend ~  Price, data = split_list[[i]])
income_log_reg[[i]] <- lm(Spend ~ log_income, data = split_list[[i]])
income_log_price_reg[[i]] <- lm(Spend ~ log_income + Price, data = split_list[[i]])
income_log_price_log_reg[[i]] <- lm(Spend ~ log_income + log_price, data = split_list[[i]])
## run Anova on intercept Model
anova_list_1[[i]] <- anova(income_reg_all[[i]],income_reg_0[[i]])
## run Anova on two variable Model
anova_list_2[[i]] <- anova(income_reg_0[[i]],income_price_reg[[i]])
## run Anova on log model
anova_list_3[[i]] <- anova(income_reg_0[[i]],income_log_reg[[i]])
## run Anova on the two two variable Model
anova_list_4[[i]] <- anova(income_price_reg[[i]],income_log_price_reg[[i]])
## Input results in data frame
anova_pr_df[i,2] <- anova_list_1[[i]][2,6]
anova_pr_df[i,3] <- summary(income_reg_all[[i]])[[4]][1,2]
anova_pr_df[i,4] <- summary(income_reg_all[[i]])[[4]][1,1]
anova_pr_df[i,5] <- summary(price_reg[[i]])[[4]][1,2]
anova_pr_df[i,6] <- summary(price_reg[[i]])[[4]][1,1]
anova_pr_df[i,7] <- summary(income_price_reg[[i]])[[4]][2,1]
anova_pr_df[i,8] <- summary(income_price_reg[[i]])[[4]][2,4]
anova_pr_df[i,9] <- summary(income_price_reg[[i]])[[4]][3,1]
anova_pr_df[i,10] <- summary(income_price_reg[[i]])[[4]][3,4]
anova_pr_df[i,11] <- summary(income_price_reg[[i]])[[4]][1,1]
anova_pr_df[i,12] <- summary(income_price_reg[[i]])[[4]][1,4]
anova_pr_df[i,13] <- summary(income_log_reg[[i]])[[4]][2,1]
anova_pr_df[i,14] <- summary(income_log_reg[[i]])[[4]][2,4]
anova_pr_df[i,15] <- summary(income_log_reg[[i]])[[4]][1,1]
anova_pr_df[i,16] <- summary(income_log_reg[[i]])[[4]][1,4]
anova_pr_df[i,17] <- anova_list_2[[i]][2,6]
anova_pr_df[i,18] <- anova_list_3[[i]][2,6]
anova_pr_df[i,19] <- summary(income_log_price_reg[[i]])[[4]][2,1]
anova_pr_df[i,20] <- summary(income_log_price_reg[[i]])[[4]][2,4]
anova_pr_df[i,21] <- summary(income_log_price_reg[[i]])[[4]][3,1]
anova_pr_df[i,22] <- summary(income_log_price_reg[[i]])[[4]][3,4]
anova_pr_df[i,23] <- summary(income_log_price_reg[[i]])[[4]][1,1]
anova_pr_df[i,24] <- summary(income_log_price_reg[[i]])[[4]][1,4]
anova_pr_df[i,25] <- anova_list_4[[i]][2,6]
anova_pr_df[i,26] <- anova_list_5[[i]][2,6]
anova_pr_df[i,27] <- summary(income_log_price_log_reg[[i]])[[4]][2,1]
anova_pr_df[i,28] <- summary(income_log_price_log_reg[[i]])[[4]][2,4]
anova_pr_df[i,29] <- summary(income_log_price_log_reg[[i]])[[4]][3,1]
anova_pr_df[i,30] <- summary(income_log_price_log_reg[[i]])[[4]][3,4]
anova_pr_df[i,31] <- summary(income_log_price_log_reg[[i]])[[4]][1,1]
anova_pr_df[i,32] <- summary(income_log_price_log_reg[[i]])[[4]][1,4]
}
for(i in 1:length(good_types)){
## run regression
income_reg_0[[i]] <- lm(Spend ~ 0 +Income.Amount, data = split_list[[i]])
income_reg_all[[i]] <- lm(Spend ~ Income.Amount, data = split_list[[i]])
income_price_reg[[i]] <- lm(Spend ~ Income.Amount + Price, data = split_list[[i]])
price_reg[[i]] <- lm(Spend ~  Price, data = split_list[[i]])
income_log_reg[[i]] <- lm(Spend ~ log_income, data = split_list[[i]])
income_log_price_reg[[i]] <- lm(Spend ~ log_income + Price, data = split_list[[i]])
income_log_price_log_reg[[i]] <- lm(Spend ~ log_income + log_price, data = split_list[[i]])
## run Anova on intercept Model
anova_list_1[[i]] <- anova(income_reg_all[[i]],income_reg_0[[i]])
## run Anova on two variable Model
anova_list_2[[i]] <- anova(income_reg_0[[i]],income_price_reg[[i]])
## run Anova on log model
anova_list_3[[i]] <- anova(income_reg_0[[i]],income_log_reg[[i]])
## run Anova on the two two variable Model
anova_list_4[[i]] <- anova(income_price_reg[[i]],income_log_price_reg[[i]])
## run Anova on the two two variable Model
anova_list_5[[i]] <- anova(income_price_reg[[i]],income_log_price_log_reg[[i]])
## Input results in data frame
anova_pr_df[i,2] <- anova_list_1[[i]][2,6]
anova_pr_df[i,3] <- summary(income_reg_all[[i]])[[4]][1,2]
anova_pr_df[i,4] <- summary(income_reg_all[[i]])[[4]][1,1]
anova_pr_df[i,5] <- summary(price_reg[[i]])[[4]][1,2]
anova_pr_df[i,6] <- summary(price_reg[[i]])[[4]][1,1]
anova_pr_df[i,7] <- summary(income_price_reg[[i]])[[4]][2,1]
anova_pr_df[i,8] <- summary(income_price_reg[[i]])[[4]][2,4]
anova_pr_df[i,9] <- summary(income_price_reg[[i]])[[4]][3,1]
anova_pr_df[i,10] <- summary(income_price_reg[[i]])[[4]][3,4]
anova_pr_df[i,11] <- summary(income_price_reg[[i]])[[4]][1,1]
anova_pr_df[i,12] <- summary(income_price_reg[[i]])[[4]][1,4]
anova_pr_df[i,13] <- summary(income_log_reg[[i]])[[4]][2,1]
anova_pr_df[i,14] <- summary(income_log_reg[[i]])[[4]][2,4]
anova_pr_df[i,15] <- summary(income_log_reg[[i]])[[4]][1,1]
anova_pr_df[i,16] <- summary(income_log_reg[[i]])[[4]][1,4]
anova_pr_df[i,17] <- anova_list_2[[i]][2,6]
anova_pr_df[i,18] <- anova_list_3[[i]][2,6]
anova_pr_df[i,19] <- summary(income_log_price_reg[[i]])[[4]][2,1]
anova_pr_df[i,20] <- summary(income_log_price_reg[[i]])[[4]][2,4]
anova_pr_df[i,21] <- summary(income_log_price_reg[[i]])[[4]][3,1]
anova_pr_df[i,22] <- summary(income_log_price_reg[[i]])[[4]][3,4]
anova_pr_df[i,23] <- summary(income_log_price_reg[[i]])[[4]][1,1]
anova_pr_df[i,24] <- summary(income_log_price_reg[[i]])[[4]][1,4]
anova_pr_df[i,25] <- anova_list_4[[i]][2,6]
anova_pr_df[i,26] <- anova_list_5[[i]][2,6]
anova_pr_df[i,27] <- summary(income_log_price_log_reg[[i]])[[4]][2,1]
anova_pr_df[i,28] <- summary(income_log_price_log_reg[[i]])[[4]][2,4]
anova_pr_df[i,29] <- summary(income_log_price_log_reg[[i]])[[4]][3,1]
anova_pr_df[i,30] <- summary(income_log_price_log_reg[[i]])[[4]][3,4]
anova_pr_df[i,31] <- summary(income_log_price_log_reg[[i]])[[4]][1,1]
anova_pr_df[i,32] <- summary(income_log_price_log_reg[[i]])[[4]][1,4]
}
anova_pr_df
write.csv(x = anova_pr_df,file = "Output_2/regression_out.csv")
summary(income_reg_0[[i]])
summary(income_reg_0[[i]])[[4]]
summary(income_reg_0[[i]])[[4]][1]
summary(income_reg_all[[i]])
summary(income_reg_all[[i]])[[4]][1,1]
summary(income_reg_all[[i]])[[4]][2,1]
## Regression Results Data Frame
income_reg_0_df <- data.frame( "good" = good_types,
"coef_1" =rep(0,length(good_types)),
"coef_pr" = rep(0),
"model_r2" = rep(0))
income_reg_all_df<- data.frame( "good" = good_types,
"int" = rep(0,length(good_types)),
"int_pr" = rep(0),
"coef_1" = rep(0),
"coef_pr" = rep(0),
"model_r2" = rep(0))
price_reg_df<- data.frame( "good" = good_types,
"int" = rep(0,length(good_types)),
"int_pr" = rep(0),
"coef_1" = rep(0),
"coef_pr" = rep(0),
"model_r2" = rep(0))
## Regression Results Data Frame
income_reg_0_df <- data.frame( "good" = good_types,
"coef_1" =rep(0,length(good_types)),
"coef_1_pr" = rep(0),
"model_r2" = rep(0))
income_reg_all_df <- data.frame( "good" = good_types,
"int" = rep(0,length(good_types)),
"int_pr" = rep(0),
"coef_1" = rep(0),
"coef_1_pr" = rep(0),
"model_r2" = rep(0))
price_reg_df <- data.frame( "good" = good_types,
"int" = rep(0,length(good_types)),
"int_pr" = rep(0),
"coef_1" = rep(0),
"coef_1_pr" = rep(0),
"model_r2" = rep(0))
income_price_reg_df <- data.frame( "good" = good_types,
"int" = rep(0,length(good_types)),
"int_pr" = rep(0),
"coef_1" = rep(0),
"coef_1_pr" = rep(0),
"coef_2" = rep(0),
"coef_2_pr" = rep(0),
"model_r2" = rep(0))
income_log_reg_df <- data.frame( "good" = good_types,
"int" = rep(0,length(good_types)),
"int_pr" = rep(0),
"coef_1" = rep(0),
"coef_1_pr" = rep(0),
"coef_2" = rep(0),
"coef_2_pr" = rep(0),
"model_r2" = rep(0))
income_log_price_reg_df <- data.frame( "good" = good_types,
"int" = rep(0,length(good_types)),
"int_pr" = rep(0),
"coef_1" = rep(0),
"coef_1_pr" = rep(0),
"coef_2" = rep(0),
"coef_2_pr" = rep(0),
"model_r2" = rep(0))
income_log_price_log_reg_df <- data.frame( "good" = good_types,
"int" = rep(0,length(good_types)),
"int_pr" = rep(0),
"coef_1" = rep(0),
"coef_1_pr" = rep(0),
"coef_2" = rep(0),
"coef_2_pr" = rep(0),
"model_r2" = rep(0))
summary(income_reg_0[[i]])[[5]]
summary(income_reg_0[[i]])[[6]]
summary(income_reg_0[[i]])
summary(income_reg_0[[i]])[[7]]
summary(income_reg_0[[i]])[[8]]
summary(income_reg_0[[i]])[[9]]
summary(income_reg_0[[i]])[[9]]
good_types <- unique(sh_df[,"Good.Name"])
split_list <- list()
multi_list <- list()
for(i in 1:length(good_types)){
split_list[[i]] <- sh_df %>%
filter(Good == i) %>%
filter(Spend !=0) %>%
mutate(log_income = log(Income.Amount)) %>%
mutate(log_price = log(Price)) %>%
mutate(Income.Bracket = paste0("perc_",Income.Group*10)) %>%
mutate(Income.Desc = case_when(
Income.Group <= 3 ~ "Low",
Income.Group <= 7 & Income.Group >3 ~ "Medium",
Income.Group >7 ~ "High"
))
multi_list[[i]] <- mh_df %>%
filter(Good == i) %>%
filter(Spend !=0) %>%
select(-Price_7)
}
## regression Lists
income_reg_0 <- list()
income_reg_all <- list()
price_reg <- list()
income_price_reg <- list()
income_log_reg <- list()
income_log_price_reg <- list()
income_log_price_log_reg <- list()
## Test Lists
anova_list_1 <- list()
anova_list_2 <- list()
anova_list_3 <- list()
anova_list_4 <- list()
anova_list_5 <- list()
## Regression Results Data Frame
income_reg_0_df <- data.frame( "good" = good_types,
"coef_1" =rep(0,length(good_types)),
"coef_1_pr" = rep(0),
"model_r2" = rep(0),
"model_ad_r2" = rep(0))
income_reg_all_df <- data.frame( "good" = good_types,
"int" = rep(0,length(good_types)),
"int_pr" = rep(0),
"coef_1" = rep(0),
"coef_1_pr" = rep(0),
"model_r2" = rep(0),
"model_ad_r2" = rep(0))
price_reg_df <- data.frame( "good" = good_types,
"int" = rep(0,length(good_types)),
"int_pr" = rep(0),
"coef_1" = rep(0),
"coef_1_pr" = rep(0),
"model_r2" = rep(0),
"model_ad_r2" = rep(0))
income_price_reg_df <- data.frame( "good" = good_types,
"int" = rep(0,length(good_types)),
"int_pr" = rep(0),
"coef_1" = rep(0),
"coef_1_pr" = rep(0),
"coef_2" = rep(0),
"coef_2_pr" = rep(0),
"model_r2" = rep(0),
"model_ad_r2" = rep(0))
income_log_reg_df <- data.frame( "good" = good_types,
"int" = rep(0,length(good_types)),
"int_pr" = rep(0),
"coef_1" = rep(0),
"coef_1_pr" = rep(0),
"coef_2" = rep(0),
"coef_2_pr" = rep(0),
"model_r2" = rep(0),
"model_ad_r2" = rep(0))
income_log_price_reg_df <- data.frame( "good" = good_types,
"int" = rep(0,length(good_types)),
"int_pr" = rep(0),
"coef_1" = rep(0),
"coef_1_pr" = rep(0),
"coef_2" = rep(0),
"coef_2_pr" = rep(0),
"model_r2" = rep(0),
"model_ad_r2" = rep(0))
income_log_price_log_reg_df <- data.frame( "good" = good_types,
"int" = rep(0,length(good_types)),
"int_pr" = rep(0),
"coef_1" = rep(0),
"coef_1_pr" = rep(0),
"coef_2" = rep(0),
"coef_2_pr" = rep(0),
"model_r2" = rep(0),
"model_ad_r2" = rep(0))
anova_pr_df <-data.frame( "good" = good_types,
"anova_pr_1" =rep(0,length(good_types)),
"anova_pr_2" =rep(0),
"anova_pr_3" =rep(0),
"anova_pr_4" = rep(0),
"anova_pr_5" = rep(0)
)
for(i in 1:length(good_types)){
## 2.1 run regression ----------------
income_reg_0[[i]] <- lm(Spend ~ 0 +Income.Amount, data = split_list[[i]])
income_reg_all[[i]] <- lm(Spend ~ Income.Amount, data = split_list[[i]])
price_reg[[i]] <- lm(Spend ~  Price, data = split_list[[i]])
income_price_reg[[i]] <- lm(Spend ~ Income.Amount + Price, data = split_list[[i]])
income_log_reg[[i]] <- lm(Spend ~ log_income, data = split_list[[i]])
income_log_price_reg[[i]] <- lm(Spend ~ log_income + Price, data = split_list[[i]])
income_log_price_log_reg[[i]] <- lm(Spend ~ log_income + log_price, data = split_list[[i]])
## run Anova on intercept Model
anova_list_1[[i]] <- anova(income_reg_all[[i]],income_reg_0[[i]])
## run Anova on two variable Model
anova_list_2[[i]] <- anova(income_reg_0[[i]],income_price_reg[[i]])
## run Anova on log model
anova_list_3[[i]] <- anova(income_reg_0[[i]],income_log_reg[[i]])
## run Anova on the two two variable Model
anova_list_4[[i]] <- anova(income_reg_0[[i]],income_log_price_log_reg[[i]])
## run Anova on the two two variable Model
anova_list_5[[i]] <- anova(income_price_reg[[i]],income_log_price_log_reg[[i]])
## 2.2 Input results in data frame -------------
## Anova
anova_pr_df[i,2] <- anova_list_1[[i]][2,6]
anova_pr_df[i,3] <- anova_list_2[[i]][2,6]
anova_pr_df[i,4] <- anova_list_3[[i]][2,6]
anova_pr_df[i,5] <- anova_list_4[[i]][2,6]
## income_reg_0
income_reg_0_df[i,2] <-  summary(income_reg_0[[i]])[[4]][1]
income_reg_0_df[i,3] <-  summary(income_reg_0[[i]])[[4]][4]
income_reg_0_df[i,4] <-  summary(income_reg_0[[i]])[[8]]
income_reg_0_df[i,5] <-  summary(income_reg_0[[i]])[[9]]
## income_reg_all_df
income_reg_all_df[i,2] <- summary(income_reg_all[[i]])[[4]][1,1]
income_reg_all_df[i,3] <- summary(income_reg_all[[i]])[[4]][1,4]
income_reg_all_df[i,4] <- summary(income_reg_all[[i]])[[4]][2,1]
income_reg_all_df[i,5] <- summary(income_reg_all[[i]])[[4]][2,4]
income_reg_all_df[i,6] <- summary(income_reg_all[[i]])[[8]]
income_reg_all_df[i,7] <- summary(income_reg_all[[i]])[[9]]
## price_reg_df
price_reg_df[i,2] <- summary(price_reg[[i]])[[4]][1,1]
price_reg_df[i,3] <- summary(price_reg[[i]])[[4]][1,4]
price_reg_df[i,4] <- summary(price_reg[[i]])[[4]][2,1]
price_reg_df[i,5] <- summary(price_reg[[i]])[[4]][2,4]
price_reg_df[i,6] <- summary(price_reg[[i]])[[8]]
price_reg_df[i,7] <- summary(price_reg[[i]])[[9]]
## income_price_reg_df
income_price_reg_df[i,2] <- summary(income_price_reg[[i]])[[4]][1,1]
income_price_reg_df[i,3] <- summary(income_price_reg[[i]])[[4]][1,4]
income_price_reg_df[i,4] <- summary(income_price_reg[[i]])[[4]][2,1]
income_price_reg_df[i,5] <- summary(income_price_reg[[i]])[[4]][2,4]
income_price_reg_df[i,6] <- summary(income_price_reg[[i]])[[4]][3,1]
income_price_reg_df[i,7] <- summary(income_price_reg[[i]])[[4]][3,4]
income_price_reg_df[i,8] <- summary(income_price_reg[[i]])[[8]]
income_price_reg_df[i,9] <- summary(income_price_reg[[i]])[[9]]
## income_log_reg_df
income_log_reg_df[i,2] <- summary(income_log_reg[[i]])[[4]][1,1]
income_log_reg_df[i,3] <- summary(income_log_reg[[i]])[[4]][1,4]
income_log_reg_df[i,4] <- summary(income_log_reg[[i]])[[4]][2,1]
income_log_reg_df[i,5] <- summary(income_log_reg[[i]])[[4]][2,4]
income_log_reg_df[i,6] <- summary(income_log_reg[[i]])[[8]]
income_log_reg_df[i,7] <- summary(income_log_reg[[i]])[[9]]
## income_price_reg_df
income_log_price_log_reg_df[i,2] <- summary(income_log_price_log_reg[[i]])[[4]][1,1]
income_log_price_log_reg_df[i,3] <- summary(income_log_price_log_reg[[i]])[[4]][1,4]
income_log_price_log_reg_df[i,4] <- summary(income_log_price_log_reg[[i]])[[4]][2,1]
income_log_price_log_reg_df[i,5] <- summary(income_log_price_log_reg[[i]])[[4]][2,4]
income_log_price_log_reg_df[i,6] <- summary(income_log_price_log_reg[[i]])[[4]][3,1]
income_log_price_log_reg_df[i,7] <- summary(income_log_price_log_reg[[i]])[[4]][3,4]
income_log_price_log_reg_df[i,8] <- summary(income_log_price_log_reg[[i]])[[8]]
income_log_price_log_reg_df[i,9] <- summary(income_log_price_log_reg[[i]])[[9]]
}
anova_pr_df
for(i in 1:length(good_types)){
## 2.1 run regression ----------------
income_reg_0[[i]] <- lm(Spend ~ 0 +Income.Amount, data = split_list[[i]])
income_reg_all[[i]] <- lm(Spend ~ Income.Amount, data = split_list[[i]])
price_reg[[i]] <- lm(Spend ~  Price, data = split_list[[i]])
income_price_reg[[i]] <- lm(Spend ~ Income.Amount + Price, data = split_list[[i]])
income_log_reg[[i]] <- lm(Spend ~ log_income, data = split_list[[i]])
income_log_price_reg[[i]] <- lm(Spend ~ log_income + Price, data = split_list[[i]])
income_log_price_log_reg[[i]] <- lm(Spend ~ log_income + log_price, data = split_list[[i]])
## run Anova on intercept Model
anova_list_1[[i]] <- anova(income_reg_all[[i]],income_reg_0[[i]])
## run Anova on two variable Model
anova_list_2[[i]] <- anova(income_reg_0[[i]],income_price_reg[[i]])
## run Anova on log model
anova_list_3[[i]] <- anova(income_reg_0[[i]],income_log_reg[[i]])
## run Anova on the two two variable Model
anova_list_4[[i]] <- anova(income_reg_0[[i]],income_log_price_log_reg[[i]])
## run Anova on the two two variable Model
anova_list_5[[i]] <- anova(income_price_reg[[i]],income_log_price_log_reg[[i]])
## 2.2 Input results in data frame -------------
## Anova
anova_pr_df[i,2] <- anova_list_1[[i]][2,6]
anova_pr_df[i,3] <- anova_list_2[[i]][2,6]
anova_pr_df[i,4] <- anova_list_3[[i]][2,6]
anova_pr_df[i,5] <- anova_list_4[[i]][2,6]
anova_pr_df[i,6] <- anova_list_5[[i]][2,6]
## income_reg_0
income_reg_0_df[i,2] <-  summary(income_reg_0[[i]])[[4]][1]
income_reg_0_df[i,3] <-  summary(income_reg_0[[i]])[[4]][4]
income_reg_0_df[i,4] <-  summary(income_reg_0[[i]])[[8]]
income_reg_0_df[i,5] <-  summary(income_reg_0[[i]])[[9]]
## income_reg_all_df
income_reg_all_df[i,2] <- summary(income_reg_all[[i]])[[4]][1,1]
income_reg_all_df[i,3] <- summary(income_reg_all[[i]])[[4]][1,4]
income_reg_all_df[i,4] <- summary(income_reg_all[[i]])[[4]][2,1]
income_reg_all_df[i,5] <- summary(income_reg_all[[i]])[[4]][2,4]
income_reg_all_df[i,6] <- summary(income_reg_all[[i]])[[8]]
income_reg_all_df[i,7] <- summary(income_reg_all[[i]])[[9]]
## price_reg_df
price_reg_df[i,2] <- summary(price_reg[[i]])[[4]][1,1]
price_reg_df[i,3] <- summary(price_reg[[i]])[[4]][1,4]
price_reg_df[i,4] <- summary(price_reg[[i]])[[4]][2,1]
price_reg_df[i,5] <- summary(price_reg[[i]])[[4]][2,4]
price_reg_df[i,6] <- summary(price_reg[[i]])[[8]]
price_reg_df[i,7] <- summary(price_reg[[i]])[[9]]
## income_price_reg_df
income_price_reg_df[i,2] <- summary(income_price_reg[[i]])[[4]][1,1]
income_price_reg_df[i,3] <- summary(income_price_reg[[i]])[[4]][1,4]
income_price_reg_df[i,4] <- summary(income_price_reg[[i]])[[4]][2,1]
income_price_reg_df[i,5] <- summary(income_price_reg[[i]])[[4]][2,4]
income_price_reg_df[i,6] <- summary(income_price_reg[[i]])[[4]][3,1]
income_price_reg_df[i,7] <- summary(income_price_reg[[i]])[[4]][3,4]
income_price_reg_df[i,8] <- summary(income_price_reg[[i]])[[8]]
income_price_reg_df[i,9] <- summary(income_price_reg[[i]])[[9]]
## income_log_reg_df
income_log_reg_df[i,2] <- summary(income_log_reg[[i]])[[4]][1,1]
income_log_reg_df[i,3] <- summary(income_log_reg[[i]])[[4]][1,4]
income_log_reg_df[i,4] <- summary(income_log_reg[[i]])[[4]][2,1]
income_log_reg_df[i,5] <- summary(income_log_reg[[i]])[[4]][2,4]
income_log_reg_df[i,6] <- summary(income_log_reg[[i]])[[8]]
income_log_reg_df[i,7] <- summary(income_log_reg[[i]])[[9]]
## income_price_reg_df
income_log_price_log_reg_df[i,2] <- summary(income_log_price_log_reg[[i]])[[4]][1,1]
income_log_price_log_reg_df[i,3] <- summary(income_log_price_log_reg[[i]])[[4]][1,4]
income_log_price_log_reg_df[i,4] <- summary(income_log_price_log_reg[[i]])[[4]][2,1]
income_log_price_log_reg_df[i,5] <- summary(income_log_price_log_reg[[i]])[[4]][2,4]
income_log_price_log_reg_df[i,6] <- summary(income_log_price_log_reg[[i]])[[4]][3,1]
income_log_price_log_reg_df[i,7] <- summary(income_log_price_log_reg[[i]])[[4]][3,4]
income_log_price_log_reg_df[i,8] <- summary(income_log_price_log_reg[[i]])[[8]]
income_log_price_log_reg_df[i,9] <- summary(income_log_price_log_reg[[i]])[[9]]
}
anova_pr_df
plot(split_list[[6]][,"Income.Amount"],split_list[[6]][,"Spend"])
plot(split_list[[1]][,"Price"],split_list[[6]][,"Spend"])
plot(split_list[[3]][,"Price"],split_list[[6]][,"Spend"])
write.csv(x = anova_pr_df,file = "Output_2/Linear Coefs/anova.csv")
## Linear
write.csv(x = anova_pr_df,file = "Output_2/Linear Coefs/anova.csv")
write.csv(x = income_reg_0_df,file = "Output_2/Linear Coefs/income_reg_0_df.csv")
write.csv(x = income_reg_all_df,file = "Output_2/Linear Coefs/income_reg_all_df.csv")
write.csv(x = price_reg_df,file = "Output_2/Linear Coefs/price_reg_df.csv")
write.csv(x = income_price_reg_df,file = "Output_2/Linear Coefs/income_price_reg_df.csv")
write.csv(x = income_log_reg_df,file = "Output_2/Linear Coefs/income_log_reg_df.csv")
write.csv(x = income_log_price_log_reg_df,file = "Output_2/Linear Coefs/income_log_price_log_reg_df.csv")
summary(income_log_reg[[i]])[[4]]
summary(income_log_reg[[i]])
summary(income_log_reg[[i]])[[8]]
income_log_reg_df <- data.frame( "good" = good_types,
"int" = rep(0,length(good_types)),
"int_pr" = rep(0),
"coef_1" = rep(0),
"coef_1_pr" = rep(0),
"model_r2" = rep(0),
"model_ad_r2" = rep(0))
for(i in 1:length(good_types)){
## 2.1 run regression ----------------
income_reg_0[[i]] <- lm(Spend ~ 0 +Income.Amount, data = split_list[[i]])
income_reg_all[[i]] <- lm(Spend ~ Income.Amount, data = split_list[[i]])
price_reg[[i]] <- lm(Spend ~  Price, data = split_list[[i]])
income_price_reg[[i]] <- lm(Spend ~ Income.Amount + Price, data = split_list[[i]])
income_log_reg[[i]] <- lm(Spend ~ log_income, data = split_list[[i]])
income_log_price_reg[[i]] <- lm(Spend ~ log_income + Price, data = split_list[[i]])
income_log_price_log_reg[[i]] <- lm(Spend ~ log_income + log_price, data = split_list[[i]])
## run Anova on intercept Model
anova_list_1[[i]] <- anova(income_reg_all[[i]],income_reg_0[[i]])
## run Anova on two variable Model
anova_list_2[[i]] <- anova(income_reg_0[[i]],income_price_reg[[i]])
## run Anova on log model
anova_list_3[[i]] <- anova(income_reg_0[[i]],income_log_reg[[i]])
## run Anova on the two two variable Model
anova_list_4[[i]] <- anova(income_reg_0[[i]],income_log_price_log_reg[[i]])
## run Anova on the two two variable Model
anova_list_5[[i]] <- anova(income_price_reg[[i]],income_log_price_log_reg[[i]])
## 2.2 Input results in data frame -------------
## Anova
anova_pr_df[i,2] <- anova_list_1[[i]][2,6]
anova_pr_df[i,3] <- anova_list_2[[i]][2,6]
anova_pr_df[i,4] <- anova_list_3[[i]][2,6]
anova_pr_df[i,5] <- anova_list_4[[i]][2,6]
anova_pr_df[i,6] <- anova_list_5[[i]][2,6]
## income_reg_0
income_reg_0_df[i,2] <-  summary(income_reg_0[[i]])[[4]][1]
income_reg_0_df[i,3] <-  summary(income_reg_0[[i]])[[4]][4]
income_reg_0_df[i,4] <-  summary(income_reg_0[[i]])[[8]]
income_reg_0_df[i,5] <-  summary(income_reg_0[[i]])[[9]]
## income_reg_all_df
income_reg_all_df[i,2] <- summary(income_reg_all[[i]])[[4]][1,1]
income_reg_all_df[i,3] <- summary(income_reg_all[[i]])[[4]][1,4]
income_reg_all_df[i,4] <- summary(income_reg_all[[i]])[[4]][2,1]
income_reg_all_df[i,5] <- summary(income_reg_all[[i]])[[4]][2,4]
income_reg_all_df[i,6] <- summary(income_reg_all[[i]])[[8]]
income_reg_all_df[i,7] <- summary(income_reg_all[[i]])[[9]]
## price_reg_df
price_reg_df[i,2] <- summary(price_reg[[i]])[[4]][1,1]
price_reg_df[i,3] <- summary(price_reg[[i]])[[4]][1,4]
price_reg_df[i,4] <- summary(price_reg[[i]])[[4]][2,1]
price_reg_df[i,5] <- summary(price_reg[[i]])[[4]][2,4]
price_reg_df[i,6] <- summary(price_reg[[i]])[[8]]
price_reg_df[i,7] <- summary(price_reg[[i]])[[9]]
## income_price_reg_df
income_price_reg_df[i,2] <- summary(income_price_reg[[i]])[[4]][1,1]
income_price_reg_df[i,3] <- summary(income_price_reg[[i]])[[4]][1,4]
income_price_reg_df[i,4] <- summary(income_price_reg[[i]])[[4]][2,1]
income_price_reg_df[i,5] <- summary(income_price_reg[[i]])[[4]][2,4]
income_price_reg_df[i,6] <- summary(income_price_reg[[i]])[[4]][3,1]
income_price_reg_df[i,7] <- summary(income_price_reg[[i]])[[4]][3,4]
income_price_reg_df[i,8] <- summary(income_price_reg[[i]])[[8]]
income_price_reg_df[i,9] <- summary(income_price_reg[[i]])[[9]]
## income_log_reg_df
income_log_reg_df[i,2] <- summary(income_log_reg[[i]])[[4]][1,1]
income_log_reg_df[i,3] <- summary(income_log_reg[[i]])[[4]][1,4]
income_log_reg_df[i,4] <- summary(income_log_reg[[i]])[[4]][2,1]
income_log_reg_df[i,5] <- summary(income_log_reg[[i]])[[4]][2,4]
income_log_reg_df[i,6] <- summary(income_log_reg[[i]])[[8]]
income_log_reg_df[i,7] <- summary(income_log_reg[[i]])[[9]]
## income_price_reg_df
income_log_price_log_reg_df[i,2] <- summary(income_log_price_log_reg[[i]])[[4]][1,1]
income_log_price_log_reg_df[i,3] <- summary(income_log_price_log_reg[[i]])[[4]][1,4]
income_log_price_log_reg_df[i,4] <- summary(income_log_price_log_reg[[i]])[[4]][2,1]
income_log_price_log_reg_df[i,5] <- summary(income_log_price_log_reg[[i]])[[4]][2,4]
income_log_price_log_reg_df[i,6] <- summary(income_log_price_log_reg[[i]])[[4]][3,1]
income_log_price_log_reg_df[i,7] <- summary(income_log_price_log_reg[[i]])[[4]][3,4]
income_log_price_log_reg_df[i,8] <- summary(income_log_price_log_reg[[i]])[[8]]
income_log_price_log_reg_df[i,9] <- summary(income_log_price_log_reg[[i]])[[9]]
}
write.csv(x = income_log_reg_df,file = "Output_2/Linear Coefs/income_log_reg_df.csv")
